!function(){function t(t,e,i){Wn[t]=i,Gn[t]=e}function e(e,i,n){if("undefined"==typeof Wn[e])t(e,i,n);else{n=n||i;for(var o in n)Wn[e][o]=n[o]}}function n(t){jn!==t&&(jn=t,Zn.eachInstance(function(){this.localeChange()}))}function o(t,e){if("undefined"!=typeof Wn[jn]&&"undefined"!=typeof Wn[jn][t])return Wn[jn][t];if("undefined"!=typeof Wn[zn]&&"undefined"!=typeof Wn[zn][t])return Wn[zn][t];for(var i in Gn)if("undefined"!=typeof Wn[i][t])return Wn[i][t];return e?!1:t}function a(t,e){if(!jn){var i=Zn.persist("locale");i&&(jn=i)}if(jn||(jn="en"),t=o(t,e===!1),t===!1)return!1;if(e){for(var n in e)t=t.replace("{{"+n+"}}",e[n]);return t}return t}function s(t){if(!t||!t.id){var e;do e="ruid-"+Math.random().toString().replace(".","");while(document.getElementById(e));if(!t)return e;t.id=e}return t.id}function r(t){for(var e in t)this[e]=t[e]}function l(t){var e=!1;for(var i in qn)"function"==typeof qn[i]?qn[i]()&&(e=!0):qn[i]&&(e=!0);if(e){var n="There are unsaved changes on this page. Are you sure you wish to navigate away?";return(t||window.event).returnValue=n,n}}function c(t){return t.charAt(0).toUpperCase()+t.slice(1)}function p(t,e){return t.replace(/([A-Z])/g,function(t){return(e||"-")+t.toLowerCase()})}function h(t,e){var i=t.toLowerCase().replace(/[^a-z0-9](.)/gi,function(t,e){return e.toUpperCase()});return e!==!1&&(i=c(i)),i}function u(t){return Vn[t]}function d(t,e){return t=t.replace(/tr\(['"]{1}(.*?)['"]{1}\)/g,function(t,e){return e=e.replace(/\\(.?)/g,function(t,e){switch(e){case"\\":return"\\";case"0":return"\0";case"":return"";default:return e}}),a(e)}),e=Kn.extend({},this.options,e||{}),e=g(e),t=t.replace(/\{\{(.*?)\}\}/g,function(t,i){return e[i]})}function g(t,e,i){e=e?e+".":"";var n=5;i||(i=1);var o={};for(var a in t)if("object"==typeof t[a]&&n>i){var s=g(t[a],e+a,++i);for(var r in s)o[r]=s[r]}else o[e+a]=t[a];return o}function f(t){return!isNaN(t-0)&&null!==t}function m(t){return"string"==typeof t}function b(t){return t instanceof Array}function y(t){return t instanceof Node}function v(t){return y(t)?t.nodeType===Node.TEXT_NODE:C(t)?y(t[0]):!1}function C(t){return t instanceof jQuery}function w(t,e){return Kn(t).button(e)}function T(t,e){return Kn(t).button("option","text",!0),Kn(t).button("option","label",e)}function k(t,e){return Kn(t).button("option","icons",{primary:e})}function E(t){return Kn(t).button("option","disabled",!1)}function S(t){return!Kn(t).is(".ui-state-disabled")}function x(t){return Kn(t).button("option","disabled",!0)}function D(t){return Kn(t).addClass("ui-state-highlight")}function R(t){return Kn(t).removeClass("ui-state-highlight")}function P(t,e){return Kn(t).menu(e)}function A(t,e){e.dialogClass="undefined"!=typeof e.dialogClass?e.dialogClass+" ui-dialog-fixed":"ui-dialog-fixed";var i=Kn(t).dialog(e);return i.parent().css({top:(parseInt(i.parent().css("top"))||0)-Kn(window).scrollTop()}),i.dialog("option","position","center"),i}function N(t){return Kn(t).dialog("open")}function B(t){return Kn(t).dialog("close")}function I(t,e){return Kn(t).tabs(e)}function O(t){"success"==t.type&&(t.state="confirmation"),Kn.pnotify(Kn.extend({type:"success",styling:"jqueryui",history:!1},t))}function M(t,e,i){return H(t,e),t=Ii(e),i(),rangy.getSelection().removeAllRanges(),t}function H(t,e){if(t){var i=Oi(e,t);return i.ranges&&rangy.getSelection().setRanges(i.ranges),i.element}return e}function L(t){t()}function U(){}function F(){}function j(t,e){for(var i in e){var n=e[i],o=!1;do if(o=Kn(t).find(i),o.length){o=Kn(o.get(0));var a=Kn(n).clone();a.html(o.html()),a.attr(le(o)),o.replaceWith(a)}while(o.length)}}function z(t){Kn(t).unwrap()}function W(t,e){for(i=0;i<e.length;i++)Kn.trim(t.attr(e[i]))||t.removeAttr(e[i]),t.find("["+e[i]+"]").filter(function(){return""===Kn.trim(Kn(this).attr(e[i]))}).removeAttr(e[i])}function G(t){return t.contents().each(function(){this.nodeType==Node.COMMENT_NODE&&Kn(this).remove()}),t.children().each(function(){G(Kn(this))}),t}function q(t,e){var i;do i=!1,t.find(e.join(",")).each(function(){""===Kn.trim(Kn(this).html())&&(Kn(this).remove(),i=!0)});while(i);return t}function V(t,e){for(var i=ke(t),n=0,o=i.length;o>n;n++){var a=i[n].cloneNode(),s=document.createElement(e);s.appendChild(a),t.insertBefore(s,i[n]),t.removeChild(i[n])}}function X(t,e){var i;do i=!1,Kn(t).find(e).each(function(){Kn(this).parent().is(e)&&(Kn(this).unwrap(),i=!0)});while(i)}function K(t){Kn(t).find(".rangySelectionBoundary").remove()}function _(t,e){var i,n=Kn("<div>").addClass("spacer");"top"===e.position?(i={position:"fixed",top:e.under?Kn(e.under).outerHeight():0,left:0,right:0},e.spacer&&(e.under?n.insertAfter(e.under):n.prependTo("body"))):"topLeft"===e.position?(i={position:"fixed",top:e.under?Kn(e.under).outerHeight():0,left:0},e.spacer&&(e.under?n.insertAfter(e.under):n.prependTo("body"))):"topRight"===e.position?(i={position:"fixed",top:e.under?Kn(e.under).outerHeight():0,right:0},e.spacer&&(e.under?n.insertAfter(e.under):n.prependTo("body"))):"bottom"===e.position?(i={position:"fixed",bottom:0,left:0,right:0},e.spacer&&n.appendTo("body")):"bottomLeft"===e.position?(i={position:"fixed",bottom:0,left:0},e.spacer&&n.appendTo("body")):"bottomRight"===e.position&&(i={position:"fixed",bottom:0,right:0},e.spacer&&n.appendTo("body"));var o=Li(t,i);return n.css("height",t.outerHeight()),setTimeout(function(){n.css("height",t.outerHeight())},300),{dockedElement:t,spacer:n,styleState:o}}function Q(t){return Fi(t.dockedElement,t.styleState),t.spacer.remove(),t.dockedElement.detach()}function J(t,e,i){var n=e.wrap("<div>").parent(),o=Ui(n,e,{"float":"none",display:"block",clear:"none",position:"static",margin:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,padding:0,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,outline:0,width:"auto",border:"none"}),a=Li(t,{position:"static"});return n.prepend(t).addClass(i.wrapperClass?i.wrapperClass:""),{dockedElement:t,dockedTo:e,innerStyleState:o,dockedElementStyleState:a}}function $(t){Fi(t.dockedTo,t.innerStyleState),Fi(t.dockedElement,t.dockedElementStyleState);var e=t.dockedElement.detach();return t.dockedTo.unwrap(),e}function Y(t,e){return t.children().each(function(){var t=Kn.map(this.attributes,function(t){return-1===Kn.inArray(t.name,e)?t.name:void 0}),i=Kn(this);Kn.each(t,function(t,e){i.removeAttr(e)}),element.removeAttributes(Kn(this),e)}),t}function Z(t){var e=1;t.siblings().each(function(){var t=Kn(this).css("z-index");!isNaN(t)&&t>e&&(e=t+1)}),t.css("z-index",e)}function te(t){return t.clone().wrap("<div/>").parent().html()}function ee(t){return t.clone().wrap("<div/>").parent().text()}function ie(t){return"block"===oe(t.tagName)}function ne(t){var e=!1;return t.contents().each(function(){return!v(this)&&ie(this)?(e=!0,void 0):void 0}),e}function oe(t){var e,i=document.createElement(t),n="getComputedStyle"in window;return document.body.appendChild(i),e=(n?window.getComputedStyle(i,""):i.currentStyle).display,document.body.removeChild(i),e}function ae(t,e){return-1!==Kn.inArray(Kn(t)[0].tagName.toLowerCase(),e)}function se(t,e,i){var n=t.parentNode;return n[0]===i[0]?t:ae(n,e)?t:se(n,e,i)}function re(t){t=Kn(t);var e={top:Math.round(t.offset().top),left:Math.round(t.offset().left),width:Math.round(t.outerWidth()),height:Math.round(t.outerHeight())},i=Kn(window).scrollTop(),n=Kn(window).height(),o=i+n,a=Math.round(e.height+e.top);return i<e.top&&o>a?e:(i>e.top&&(e.top=i),e.height=a>o?o-e.top:n-(o-a),e)}function le(t){for(var e=Kn(t).get(0).attributes,i={},n=0,o=e.length;o>n;n++)i[e[n].name]=e[n].value;return i}function ce(t){for(var e={},i=window.getComputedStyle(t[0],null),n=0;n<i.length;n++)e[i.item(n)]=i.getPropertyValue(i.item(n));return e}function pe(t,e){var i=new jQuery;Ke();for(var n=0,o=t.length;o>n;n++){var a=Kn("<"+e+"/>").html(Kn(t[n]).html());t.html(a),i.push(a[0])}return _e(),i}function he(t,e){Kn.each(e,function(e,i){Kn(t).css(e)===i?Kn(t).css(e,""):Kn(t).css(e,i)})}function ue(t,e,i){for(var n in i)t.css(n,e.css(n)),e.css(n,i[n])}function de(t){return t.is("img")||t.find("img").length?!1:/&nbsp;/.test(t.html())?!1:""===t.text()}function ge(t,e){var i=Kn(e).offset(),n=Kn(e).outerHeight();Kn(t).css({top:i.top+n-Kn(window).scrollTop()+"px",left:i.left+"px"})}function fe(t,e){var i=Kn(t).parent();Kn(t).detach(),e(t),i.append(t)}function me(t,e){for(;t.length>0&&t[0]!==e[0]&&(t[0].nodeType===Node.TEXT_NODE||"inline"===t.css("display"));)t=t.parent();return t[0]===e[0]?null:t}function be(){for(var t="ruid-"+(new Date).getTime()+"-"+Math.floor(1e5*Math.random());Kn("#"+t).length;)t="ruid-"+(new Date).getTime()+"-"+Math.floor(1e5*Math.random());return t}function ye(t,e){for(var i=[],n=t.length-1;n>=0;n--){var o=document.createElement(e);o.innerHTML=t[n].innerHTML,Kn.each(t[n].attributes,function(){Kn(o).attr(this.name,this.value)}),Kn(t[n]).after(o).remove(),i[n]=o}return Kn(i)}function ve(t,e){if(t.outerHeight()>e.outerHeight()-20){var i=re(e),n=e.offset();t.css({position:"absolute",top:n.top-t.outerHeight(),left:i.left+(i.width/2-t.outerWidth()/2)})}else{var i=re(e);t.css({position:"absolute",top:i.top+(i.height/2-t.outerHeight()/2),left:i.left+(i.width/2-t.outerWidth()/2)})}}function Ce(t,e){for(var i="",n=0,o=t.childNodes.length;o>n;n++){var a=t.childNodes.item(n),s=a.nodeType===Node.TEXT_NODE?a.nodeValue:te(Kn(a));s&&(i+=s)}return e&&(i=Kn("<"+e+">"+i+"</"+e+">"),i.find("p").wrapInner("<"+e+"/>"),i.find("p > *").unwrap(),i=Kn("<div/>").html(i).html()),i}function we(t,e,i){for(var n=0,o=t.childNodes.length;o>n;n++){var a=t.childNodes.item(n),s=a.nodeType===Node.TEXT_NODE?a.nodeValue:Kn(a).html();s&&Kn("<"+i+"/>").html(Kn.trim(s)).insertBefore(e)}}function Te(t){for(;t.nodeType===Node.TEXT_NODE;)t=t.parentNode;return t}function ke(t){for(var e=[],i=/^\s*$/,n=0,o=t.childNodes.length;o>n;n++)t.childNodes[n].nodeType==Node.TEXT_NODE&&(i.test(t.childNodes[n].nodeValue)||e.push(t.childNodes[n]));return e}function Ee(t,e){for(var i=t.parentNode;null!=i;){if(i==e)return!0;i=i.parentNode}return!1}function Se(t,e){if(localStorage){var i;i=localStorage.raptor?JSON.parse(localStorage.raptor):{},i[t]=e,localStorage.raptor=JSON.stringify(i)}}function xe(t){if(localStorage){var e;return e=localStorage.raptor?JSON.parse(localStorage.raptor):{},e[t]}}function De(t){t.setStartBefore(t.startContainer),t.setEndAfter(t.endContainer)}function Re(t,e){t.selectNode(Kn(e)[0])}function Pe(t,e){t.selectNodeContents(Kn(e).get(0))}function Ae(t,e){do{De(t);for(var i=0,n=e.length;n>i;i++)if(Kn(t.commonAncestorContainer).is(e[i]))return}while(t.commonAncestorContainer)}function Ne(t,e){var i=[],n=Kn("<div/>").append(e)[0].childNodes;return t.deleteContents(),void 0===n.length||1===n.length?t.insertNode(n[0].cloneNode(!0)):Kn.each(n,function(e,n){i.unshift(n.cloneNode(!0)),t.insertNodeAtEnd(i[0])}),i}function Be(t){var e=Ve(t);return"string"==typeof e&&(e=e.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1")),Hi(e)}function Ie(t){return Te(t.startContainer)}function Oe(t){return Te(t.endContainer)}function Me(t){return Te(t.commonAncestorContainer)}function He(t){return t.startOffset===t.endOffset&&t.startContainer===t.endContainer}function Le(t,e){var i=t.cloneRange();return i.selectNodeContents(e),i.containsRange(t)}function Ue(t,e){return t.containsNode(e)}function Fe(t,e){return t.containsNodeText(e)}function je(t){if(t.startContainer.data)for(;/\s/.test(t.startContainer.data.substr(t.startOffset,1));)t.setStart(t.startContainer,t.startOffset+1);if(t.endContainer.data)for(;t.endOffset>0&&/\s/.test(t.endContainer.data.substr(t.endOffset-1,1));)t.setEnd(t.endContainer,t.endOffset-1)}function ze(t,e){return rangy.serializeRange(t,!0,e)}function We(t,e){for(var i=t.split("|"),n=[],o=0,a=i.length;a>o;o++)n[o]=rangy.deserializeRange(i[o],e);return n}function Ge(t,e,i,n){var o=Me(t);ae(o,n)||(o=se(o,n,i));var a=rangy.createRange();a.setStartBefore(o),a.setEnd(t.startContainer,t.startOffset);var s=a.cloneContents(),r=rangy.createRange();r.setStart(t.endContainer,t.endOffset),r.setEndAfter(o);var l=r.cloneContents(),c=te(Kn(Ce(s)));return c+=te(Kn(e).attr("data-replacement",!0)),c+=te(Kn(Ce(l))),c=Kn(c),Kn(o).replaceWith(c),c=c.parent().find("[data-replacement]").removeAttr("data-replacement"),c.prev().is(o.tagName.toLowerCase())&&!c.prev().html().trim()&&c.prev().remove(),c.next().is(o.tagName.toLowerCase())&&!c.next().html().trim()&&c.next().remove(),c}function qe(t,e,i,n){var o=Te(t.startContainer),a=Te(t.endContainer),s=Me(t),r=ae(s,n),l=ae(o,n),c=ae(a,n);return r&&l&&c?Ne(t,e):Ge(t,e,i,n)}function Ve(t){return Ce(t.cloneContents())}function Xe(){var t=rangy.getSelection();return t.rangeCount>0?t.getRangeAt(0):null}function Ke(t){(!Xn||t)&&(Xn=rangy.saveSelection())}function _e(){Xn&&(rangy.restoreSelection(Xn),Xn=!1)}function Qe(){Xn&&rangy.removeMarkers(Xn),Xn=!1}function Je(){return Xn!==!1}function $e(t,e,i){e=e||rangy.getSelection();for(var n,o=0;n=e.getAllRanges()[o++];)t.call(i,n)}function Ye(t){rangy.getSelection().setSingleRange(t)}function Ze(t,e){var i=[];return $e(function(e){i=i.concat(Ne(e,t))},e,this),i}function ti(t,e){e=e||rangy.getSelection();var i=rangy.createRange();i.selectNodeContents(t),e.setSingleRange(i)}function ei(t){var e=rangy.createRange();e.selectNode(t),rangy.getSelection().setSingleRange(e)}function ii(t,e,i){e=e||rangy.getSelection(),e.removeAllRanges(),Kn(t).each(function(){var t=rangy.createRange();t.selectNodeContents(this),t.collapse(i),e.addRange(t)})}function ni(t,e){ii(t,e,!1)}function oi(t,e){ii(t,e,!0)}function ai(t,e){e=e||rangy.getSelection();var i=bi();e.removeAllRanges(),i.setEndAfter(t.get(0)),e.addRange(i)}function si(t){return t=t||rangy.getSelection(),t.toHtml()}function ri(t,e){if(e=e||rangy.getSelection(),!mi())return new jQuery;var i,t=bi();return i=t.commonAncestorContainer.nodeType===Node.TEXT_NODE?t.commonAncestorContainer.parentNode:t.commonAncestorContainer,Kn(i)}function li(t){var e=new jQuery;return $e(function(t){e.push(ri(t)[0])},t,this),e}function ci(){var t=rangy.getSelection();return null===t.anchorNode?null:t.isBackwards()?t.focusNode.nodeType===Node.TEXT_NODE?Kn(t.focusNode.parentElement):Kn(t.focusNode):(t.anchorNode||console.trace(),t.anchorNode.nodeType===Node.TEXT_NODE?Kn(t.anchorNode.parentElement):Kn(t.anchorNode))}function pi(){var t=rangy.getSelection();return null===t.anchorNode?null:t.isBackwards()?t.anchorNode.nodeType===Node.TEXT_NODE?Kn(t.anchorNode.parentElement):Kn(t.anchorNode):t.focusNode.nodeType===Node.TEXT_NODE?Kn(t.focusNode.parentElement):Kn(t.focusNode)}function hi(){var t=rangy.getSelection(),e=t.isBackwards()?t.anchorNode:t.focusNode,i=t.isBackwards()?t.focusOffset:t.anchorOffset;if(i!==e.textContent.length)return!1;var n=e.nextSibling;return n&&""!==Kn(n).html()?!1:!0}function ui(){var t=rangy.getSelection(),e=t.isBackwards()?t.focusNode:t.anchorNode;if(t.isBackwards()?t.focusOffset:0!==t.anchorOffset)return!1;var i=e.previousSibling;return i&&""!==Kn(i).html()?!1:!0}function di(){return""===rangy.getSelection().toHtml()}function gi(t,e){e=e||{};var i=rangy.createCssClassApplier(e.classes||"",{normalize:!0,elementTagName:t,elementProperties:e.attributes||{}});$e(function(n){if(Be(n)){var o=Kn("<"+t+"/>").addClass(e.classes).attr(e.attributes||{}).append(Ce(n.cloneContents()));Ne(n,o)}else i.toggleRange(n)},null,this)}function fi(t,e,i){$e(function(n){var o=ri(n);o.is(t)?o.attr(e):gi(t,{classes:i,attributes:e})},null,this)}function mi(){return 0!==rangy.getSelection().rangeCount}function bi(){return rangy.getSelection().getRangeAt(0)}function yi(t,e){e=e||rangy.getSelection();var i=i(),n=li()[0],o=rangy.createRange();o.setStartBefore(n),o.setEnd(i.startContainer,i.startOffset);var a=o.cloneContents(),s=rangy.createRange();s.setStart(i.endContainer,i.endOffset),s.setEndAfter(n);var r=s.cloneContents(),l=te(Kn(Ce(a)));return l+=te(Kn(t).attr("data-replacement",!0)),l+=te(Kn(Ce(r))),l=Kn(l),Kn(n).replaceWith(l),l.parent().find("[data-replacement]").removeAttr("data-replacement")}function vi(t,e,i){if(i=i||rangy.getSelection(),mi()){var n=ci()[0],o=pi()[0],a=li()[0],s=ae(a,e),r=ae(n,e),l=ae(o,e);return s&&r&&l?Ze(t):yi(t,i)}}function Ci(t,e){$e(function(i){for(var n=Kn(i.commonAncestorContainer);n.length&&n[0]!==e[0]&&(n[0].nodeType===Node.TEXT_NODE||"inline"===n.css("display"));)n=n.parent();n[0]===e[0]&&"inline"!==e.css("display")&&(pe(e,"div"),n=e.children().first()),he(n,t)},null,this)}function wi(t,e,i){$e(function(n){var o,a=me(Kn(n.startContainer),e),s=me(Kn(n.endContainer),e);if(a&&s){a.is(s)?o=a:a&&s&&(o=a.nextUntil(s).andSelf().add(s));for(var r=0,l=o.length;l>r;r++)t(o[r])}else t(pe(e,i).get(0))})}function Ti(t,e,i,n){var o=!1,a=new jQuery;wi(function(e){if(a.push(e),!o)for(var i=0,n=t.length;n>i;i++)Kn(e).hasClass(t[i])||(o=!0)},i,n),Kn(a).removeClass(e.join(" ")),o?Kn(a).addClass(t.join(" ")):Kn(a).removeClass(t.join(" "))}function ki(t,e){e=e||rangy.getSelection();for(var i=e.getAllRanges(),n=[],o=0,a=i.length;a>o;o++){var s=i[o].cloneRange();i[o].startContainer===t||Ee(i[o].startContainer,t)||s.setStart(t,0),i[o].endContainer===t||Ee(i[o].endContainer,t)||s.setEnd(t,t.childNodes.length),n.push(s)}e.setRanges(n)}function Ei(t,e){if(t=t||document.body,e=e||rangy.getSelection(),mi()){var i=bi().cloneRange(),n=i.extractContents();""===Ce(n)&&(Pe(i,i.commonAncestorContainer),e.setSingleRange(i),n=i.extractContents()),n=Kn("<div/>").append(Ce(n)).html().replace(/(<\/?.*?>)/gi,function(t){return null!==t.match(/^<(img|object|param|embed|iframe)/)?t:""});for(var o=i.commonAncestorContainer;o&&o.parentNode!==t;)o=o.parentNode;if(o){i.setEndAfter(o);var a=i.extractContents();i.collapseAfter(o),i.insertNode(a),i.collapseAfter(o)}n=Kn.parseHTML(n),null!==n&&Kn(n.reverse()).each(function(){return Kn(this).is("img")?(i.insertNode(Kn(this).removeAttr("width height class style").get(0)),void 0):(i.insertNode(this),void 0)})}}function Si(t,e,i,n){Ke();var o="domTools"+Math.ceil(1e7*Math.random());$e(function(t){var a=rangy.createCssClassApplier(n,{elementTagName:i});a.isAppliedToRange(t)?a.toggleSelection():rangy.createCssClassApplier(e,{elementTagName:o}).toggleSelection()},null,this),Kn(o).each(function(){Kn(this).replaceWith(Kn("<"+t+"/>").addClass(e).html(Kn(this).html()))}),_e()}function xi(){var t=rangy.getSelection().getAllRanges();1===t.length&&""===Ve(t[0])&&rangy.getSelection().expand("word")}function Di(t,e,i){for(var n=rangy.getSelection().getAllRanges(),o=0,a=n.length;a>o;o++){var s=Kn(Te(n[o].startContainer));(i||!s.is(t)&&!s.is(e))&&(s=s.parentsUntil(e,t)),s=i?s.last():s.first(),1!==s.length||s.is(e)||n[o].setStart(s[0],0),s=Kn(Te(n[o].endContainer)),(i||!s.is(t)&&!s.is(e))&&(s=s.parentsUntil(e,t)),s=i?s.last():s.first(),1!==s.length||s.is(e)||n[o].setEnd(s[0],s[0].childNodes.length)}rangy.getSelection().setRanges(n)}function Ri(){if(mi()){var t=bi();je(t),Ye(t)}}function Pi(t,e){var i=new jQuery;return $e(function(n){for(var o=n.startContainer;o.nodeType===Node.TEXT_NODE;)o=o.parentNode;for(var a=n.endContainer;a.nodeType===Node.TEXT_NODE;)a=a.parentNode;var s=function(){e.is(this)||i.push(this)};do{if(Kn(o).filter(t).each(s),e.is(o)||0!==i.length||Kn(o).parentsUntil(e,t).each(s),Kn(o).find(t).each(s),Kn(a).is(o))break;o=Kn(o).next()}while(o.length>0&&0===Kn(o).prevAll().has(a).length)}),i}function Ai(t,e,i){var n=Pi(e.join(","),i);if(n.length)Ke(),ye(n,t),_e();else{var o=i.get(0);o.innerHTML.trim()?(Ke(),o.innerHTML="<"+t+">"+o.innerHTML+"</"+t+">",_e()):(o.innerHTML="<"+t+">&nbsp;</"+t+">",ti(o.childNodes[0]))}}function Ni(t,e){var i=!0;return $e(function(n){var o=Kn(n.commonAncestorContainer).find("*");0!==Kn(n.commonAncestorContainer).parentsUntil(e,t).length||0!==o.length&&o.length===o.filter(t).length||(i=!1)}),i}function Bi(t){t=t||rangy.getSelection(),t.deleteFromDocument()}function Ii(t){var e=Xe();return{element:t.clone(!0),ranges:e?ze(e,t.get(0)):null}}function Oi(t,e){t.replaceWith(e.element);var i=null;try{e.ranges&&(i=We(e.ranges,e.element.get(0)))}catch(n){}return{element:e.element,ranges:i}}function Mi(t,e){allowed=[];for(var i=0;i<e.length;i++)e[i].match(/[a-z][a-z0-9]{0,}/g)&&allowed.push(e[i]);var n=/<\/?([a-z][a-z0-9]*)\b[^>]*\/?>/gi,o=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return t.replace(o,"").replace(n,function(t,e){return allowed.indexOf(e.toLowerCase())>-1?t:""})}function Hi(t){return Kn(Kn.parseHTML(t)).is(":empty")}function Li(t,e){var i=t.get(0),n={};for(var o in e)n[o]=i.style[o];for(o in e)t.css(o,e[o]);return n}function Ui(t,e,i){var n=e.get(0),o={};for(var a in i)o[a]=n.style[a];for(a in i)t.css(a,e.css(a)),e.css(a,i[a]);return o}function Fi(t,e){for(var i in e)t.css(i,e[i]||"")}function ji(t,e,i){i=i||{};for(var n=document.createElement("table");e--;)for(var o=n.insertRow(0),a=0;t>a;a++){var s=o.insertCell(0);i.placeHolder&&(s.innerHTML=i.placeHolder)}return n}function zi(t,e,i){return resizeTable(t,0,0,1,e,i||{})}function Wi(t,e){resizeTable(t,0,0,-1,e)}function Gi(t,e,i){var n=new GoogTable(t);return n.insertRow(e,i)}function qi(t,e){resizeTable(t,-1,e,0,0)}function Vi(t){for(var e,i,n,o,a=[],s=t.parentNode.parentNode.parentNode.tBodies[0].rows,r=0;r<s.length;r++){i=s[r].sectionRowIndex,i=r;for(var l=0;l<s[r].cells.length;l++){for(e=l;a[i]&&a[i][e];)e++;for(n=e;n<e+(s[r].cells[l].colSpan||1);++n)for(o=i;o<i+(s[r].cells[l].rowSpan||1);++o)a[o]||(a[o]=[]),a[o][n]=!0;if(t===s[r].cells[l])return{x:e,y:i}}}}function Xi(t,e){for(var i=t.tBodies[0].rows,n=0;n<i.length;n++)for(var o=0;o<i[n].cells.length;o++){var a=Vi(i[n].cells[o]);if(a.x===e.x&&a.y===e.y)return i[n].cells[o]}return null}function Ki(t,e,i){for(var n=Math.min(e.x,i.x),o=n,a=Math.min(e.y,i.y),s=Math.max(e.x,i.x),r=Math.max(e.y,i.y),l=[];r>=a;){for(;s>=o;){var c=Xi(t,{x:o,y:a});null!==c&&l.push(c),o++}o=n,a++}return l}function _i(){}function Qi(t,e,i,n,o){var a=new GoogTable(t);a.mergeCells(e,i,n,o)}function Ji(){}function $i(t,e,i){var n=new GoogTable(t);n.splitCell(e,i)}function Yi(t){for(var e=0,i=t.rows.length;i>e;e++)if(t.rows[e].cells.length>0)return!1;return!0}function Zi(t){return t instanceof rangy.WrappedRange}function tn(t){return t instanceof rangy.WrappedSelection}function en(){if(void 0===_n){_n=!0,Qn=/(iPhone|iPod|iPad).*AppleWebKit/i.test(navigator.userAgent),Qn&&(Kn("html").addClass("raptor-ios"),Qn&&Kn(document).on("scroll",function(){setInterval(function(){Kn("body").css("height","+=1").css("height","-=1")},0)})),$n=/Firefox/i.test(navigator.userAgent),$n&&Kn("html").addClass("raptor-ff");var t=function(){var t=-1;return-1!=navigator.appVersion.indexOf("MSIE")&&(t=parseFloat(navigator.appVersion.split("MSIE")[1])),t}();Yn=-1!==t,Yn&&9>t&&(_n=!1,Kn(function(){var t=Kn("<div/>").addClass("raptor-unsupported").html('<div class="raptor-unsupported-overlay"></div><div class="raptor-unsupported-content">    It has been detected that you a using a browser that is not supported by Raptor, please    use one of the following browsers:    <ul>        <li><a href="http://www.google.com/chrome">Google Chrome</a></li>        <li><a href="http://www.firefox.com">Mozilla Firefox</a></li>        <li><a href="http://windows.microsoft.com/ie">Internet Explorer</a></li>    </ul>    <div class="raptor-unsupported-input">        <button class="raptor-unsupported-close">Close</button>        <input name="raptor-unsupported-show" type="checkbox" />        <label>Don\'t show this message again</label>    </div><div>').appendTo("body"),e=function(t){var e=1;t.siblings().each(function(){var t=Kn(this).css("z-index");!isNaN(t)&&t>e&&(e=t+1)}),t.css("z-index",e)};e(t),t.find(".raptor-unsupported-close").click(function(){t.remove()})})),Jn=void 0!==jQuery.hotkeys}return _n}function nn(t){this.name=t}function on(t,e){this.name=t;for(var i in e)this[i]=e[i]}function an(t,e){this.raptor=t,this.uiOrder=e}function sn(){nn.call(this,"toolbar"),this.wrapper=null}function rn(){nn.call(this,"hoverPanel"),this.hoverPanel=null,this.visible=!1}function ln(){nn.call(this,"elementHoverPanel"),this.elements="img",this.hoverPanel=null,this.visible=!1,this.target=null,this.enabled=!0}function cn(t){this.text=!1,this.label=null,this.icon=null,this.hotkey=null;for(var e in t)this[e]=t[e]}function pn(t){this.preview=!0,this.previewing=!1,cn.call(this,t)}function hn(t){this.disable=!1,cn.call(this,t)}function un(t){pn.call(this,t)}function dn(t){cn.call(this,t)}function gn(t){un.call(this,t)}function fn(t){this.state=null,cn.call(this,t)}function mn(t){fn.call(this,t),hn.call(this,t)}function bn(t,e){this.menu=t,this.name=t.name,this.raptor=t.raptor,this.options=t.options,cn.call(this,e)}function yn(t){this.menu=null,this.menuContent="",this.button=null;for(var e in t)this[e]=t[e]}function vn(t){yn.call(this,t)}function Cn(){vn.call(this,{name:"classMenu"})}function wn(){this.options={colors:{white:"#ffffff",black:"#000000",grey:"#999",blue:"#4f81bd",red:"#c0504d",green:"#9bbb59",purple:"#8064a2",orange:"#f79646"}},this.currentColor="automatic",vn.call(this,{name:"colorMenuBasic"})}function Tn(t,e){this.options={dockToElement:!1,docked:!1,position:"top",spacer:!0,persist:!0,dockTo:null},this.dockState=!1,this.marker=!1,on.call(this,t||"dock",e)}function kn(t){this.raptor=t,this.label=a("linkTypeDocumentLabel")}function En(t){this.raptor=t,this.label=a("linkTypeEmailLabel")}function Sn(t){this.raptor=t,this.label=a("linkTypeExternalLabel")}function xn(t){this.raptor=t,this.label=a("linkTypeInternalLabel")}function Dn(t,e){on.call(this,t||"noBreak",e)}function Rn(t,e){on.call(this,t||"normaliseLineBreaks",e)}function Pn(t,e){this.options={allowedTags:["h1","h2","h3","h4","h5","h6","ul","ol","li","blockquote","p","a","span","hr","br","strong","em"],allowedAttributes:["href","title"],allowedEmptyTags:["hr","br"],panels:["formatted-clean","plain-text","formatted-unclean","source"]},on.call(this,t||"paste",e)}function An(t,e){this.options={content:a("placeholderPluginDefaultContent"),tag:"p",select:!0},on.call(this,t||"placeholder",e)}function Nn(){vn.call(this,{name:"snippetMenu"})}function Bn(t){dn.call(this,t)}function In(){yn.call(this,{name:"tableCreate"})}function On(t,e){on.call(this,t||"tableSupport",e)}function Mn(){vn.call(this,{name:"tagMenu"})}function Hn(t){un.call(this,t)}function Ln(t,e){on.call(this,t||"toolTip",e)}function Un(t,e){on.call(this,t||"unsavedEditWarning",e)}var Fn={};Fn.prepare=function(t){var e=[];for(var i in t)e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e.join("&")},Fn.send=function(t,e,i,n,o){var a=new XMLHttpRequest;a.open(i,t,o),a.onreadystatechange=function(){4==a.readyState&&e(a.responseText,a)},a.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"==i&&a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(n)},Fn.get=function(t,e,i,n){Fn.send(t+(e?"?"+Fn.prepare(e):""),i,"GET",null,n)},Fn.post=function(t,e,i,n){Fn.send(t,i,"POST",Fn.prepare(e),n)};var jn=null,zn="en",Wn={},Gn={};r.prototype.init=function(){};var qn={};jQuery(window).on("beforeunload",l);var Vn={unsupported:'<div class="{{baseClass}}-unsupported-overlay"></div> <div class="{{baseClass}}-unsupported-content"> It has been detected that you a using a browser that is not supported by Raptor, please use one of the following browsers: <ul> <li><a href="http://www.google.com/chrome">Google Chrome</a></li> <li><a href="http://www.firefox.com">Mozilla Firefox</a></li> <li><a href="http://www.google.com/chromeframe">Internet Explorer with Chrome Frame</a></li> </ul> <div class="{{baseClass}}-unsupported-input"> <button class="{{baseClass}}-unsupported-close">Close</button> <input name="{{baseClass}}-unsupported-show" type="checkbox" /> <label>Don\'t show this message again</label> </div> <div>',"class-menu.item":'<li><a data-value="{{value}}">{{label}}</a></li>',"click-button-to-edit.button":"<button class=\"{{baseClass}}-button\">tr('clickButtonToEditPluginButton')</button>","color-menu-basic.automatic":'<li><a data-color="automatic"><div class="{{baseClass}}-swatch" style="display: none"></div> <span>tr(\'colorMenuBasicAutomatic\')</span></a></li>',"color-menu-basic.item":'<li><a data-color="{{className}}"><div class="{{baseClass}}-swatch" style="background-color: {{color}}"></div> <span>{{label}}</span></a></li>',"embed.dialog":'<div class="{{baseClass}}-panel-tabs ui-tabs ui-widget ui-widget-content ui-corner-all"> <ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"> <li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a>tr(\'embedDialogTabCode\')</a></li> <li class="ui-state-default ui-corner-top"><a>tr(\'embedDialogTabPreview\')</a></li> </ul> <div class="{{baseClass}}-code-tab"> <p>tr(\'embedDialogTabCodeContent\')</p> <textarea></textarea> </div> <div class="{{baseClass}}-preview-tab" style="display: none"> <p>tr(\'embedDialogTabPreviewContent\')</p> <div class="{{baseClass}}-preview"></div> </div> </div>',"image-resize.dialog":'<div class="raptor-resize-image"> <div> <label for="{{baseClass}}-width">tr(\'imageResizeDialogWidth\')</label> <input class="form-text" id="{{baseClass}}-width" name="width" type="text" placeholder="tr(\'imageResizeDialogWidthPlaceHolder\')"/> </div> <div> <label for="{{baseClass}}-height">tr(\'imageResizeDialogHeight\')</label> <input class="form-text" id="{{baseClass}}-height" name="height" type="text" placeholder="tr(\'imageResizeDialogHeightPlaceHolder\')"/> </div> <div class="{{baseClass}}-lock-proportions-container"> <span class="{{baseClass}}-lock-proportions"> <span class="ui-button-text">Constrain proportions</span> <span class="ui-icon ui-icon-locked"></span> </span> </div> </div>',"insert-file.dialog":'<div> <div> <label class="form-label">tr(\'insertFileURLLabel\')</label> <input type="text" name="location" class="form-text" placeholder="tr(\'insertFileURLPlaceHolder\')"/> </div> <div> <label class="form-label">tr(\'insertFileNameLabel\')</label> <input type="text" name="name" class="form-text" placeholder="tr(\'insertFileNamePlaceHolder\')"/> </div> </div>',"link.dialog":'<div style="display:none" class="{{baseClass}}-panel"> <div class="{{baseClass}}-menu"> <p>tr(\'linkCreateDialogMenuHeader\')</p> <fieldset data-menu=""></fieldset> </div> <div class="{{baseClass}}-wrap"> <div class="{{baseClass}}-content" data-content=""></div> </div> </div>',"link.document":'<h2>tr(\'linkTypeDocumentHeader\')</h2> <fieldset> <label for="{{baseClass}}-document-href">tr(\'linkTypeDocumentLocationLabel\')</label> <input id="{{baseClass}}-document-href" value="http://" name="location" class="{{baseClass}}-document-href" type="text" placeholder="tr(\'linkTypeDocumentLocationPlaceHolder\')" /> </fieldset> <h2>tr(\'linkTypeDocumentNewWindowHeader\')</h2> <fieldset> <label for="{{baseClass}}-document-target"> <input id="{{baseClass}}-document-target" name="blank" type="checkbox" /> <span>tr(\'linkTypeDocumentNewWindowLabel\')</span> </label> </fieldset> tr(\'linkTypeDocumentInfo\')',"link.email":'<h2>tr(\'linkTypeEmailHeader\')</h2> <fieldset class="{{baseClass}}-email"> <label for="{{baseClass}}-email">tr(\'linkTypeEmailToLabel\')</label> <input id="{{baseClass}}-email" name="email" type="text" placeholder="tr(\'linkTypeEmailToPlaceHolder\')"/> </fieldset> <fieldset class="{{baseClass}}-email"> <label for="{{baseClass}}-email-subject">tr(\'linkTypeEmailSubjectLabel\')</label> <input id="{{baseClass}}-email-subject" name="subject" type="text" placeholder="tr(\'linkTypeEmailSubjectPlaceHolder\')"/> </fieldset>',"link.error":'<div style="display:none" class="ui-widget {{baseClass}}-error-message {{messageClass}}"> <div class="ui-state-error ui-corner-all"> <p> <span class="ui-icon ui-icon-alert"></span> {{message}} </p> </div> </div>',"link.external":'<h2>tr(\'linkTypeExternalHeader\')</h2> <fieldset> <label for="{{baseClass}}-external-href">tr(\'linkTypeExternalLocationLabel\')</label> <input id="{{baseClass}}-external-href" value="http://" name="location" class="{{baseClass}}-external-href" type="text" placeholder="tr(\'linkTypeExternalLocationPlaceHolder\')" /> </fieldset> <h2>tr(\'linkTypeExternalNewWindowHeader\')</h2> <fieldset> <label for="{{baseClass}}-external-target"> <input id="{{baseClass}}-external-target" name="blank" type="checkbox" /> <span>tr(\'linkTypeExternalNewWindowLabel\')</span> </label> </fieldset> tr(\'linkTypeExternalInfo\')',"link.file-url":'<h2>tr(\'Link to a document or other file\')</h2> <fieldset> <label for="{{baseClass}}-external-href">tr(\'Location\')</label> <input id="{{baseClass}}-external-href" value="http://" name="location" class="{{baseClass}}-external-href" type="text" placeholder="tr(\'Enter your URL\')" /> </fieldset> <h2>tr(\'New window\')</h2> <fieldset> <label for="{{baseClass}}-external-target"> <input id="{{baseClass}}-external-target" name="blank" type="checkbox" /> <span>tr(\'Check this box to have the file open in a new browser window\')</span> </label> </fieldset> <h2>tr(\'Not sure what to put in the box above?\')</h2> <ol> <li>tr(\'Ensure the file has been uploaded to your website\')</li> <li>tr(\'Open the uploaded file in your browser\')</li> <li>tr("Copy the file\'s URL from your browser\'s address bar and paste it into the box above")</li> </ol>',"link.internal":'<h2>tr(\'linkTypeInternalHeader\')</h2> <fieldset> <label for="{{baseClass}}-internal-href">tr(\'linkTypeInternalLocationLabel\') {{domain}}</label> <input id="{{baseClass}}-internal-href" value="" name="location" class="{{baseClass}}-internal-href" type="text" placeholder="tr(\'linkTypeInternalLocationPlaceHolder\')" /> </fieldset> <h2>tr(\'linkTypeInternalNewWindowHeader\')</h2> <fieldset> <label for="{{baseClass}}-internal-target"> <input id="{{baseClass}}-internal-target" name="blank" type="checkbox" /> <span>tr(\'linkTypeInternalNewWindowLabel\')</span> </label> </fieldset> tr(\'linkTypeInternalInfo\')',"link.label":'<label> <input type="radio" name="link-type" autocomplete="off"/> <span>{{label}}</span> </label>',"paste.dialog":'<div class="{{baseClass}}-panel ui-dialog-content ui-widget-content"> <div class="{{baseClass}}-panel-tabs ui-tabs ui-widget ui-widget-content ui-corner-all"> <ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"> <li class="{{baseClass}}-tab-formatted-clean ui-state-default ui-corner-top ui-state-active ui-tabs-selected" style="display: none"><a>tr(\'pasteDialogFormattedCleaned\')</a></li> <li class="{{baseClass}}-tab-plain-text ui-state-default ui-corner-top" style="display: none"><a>tr(\'pasteDialogPlain\')</a></li> <li class="{{baseClass}}-tab-formatted-unclean ui-state-default ui-corner-top" style="display: none"><a>tr(\'pasteDialogFormattedUnclean\')</a></li> <li class="{{baseClass}}-tab-source ui-state-default ui-corner-top" style="display: none"><a>tr(\'pasteDialogSource\')</a></li> </ul> <div class="{{baseClass}}-content-formatted-clean" style="display: none"> <div contenteditable="true" class="{{baseClass}}-area {{baseClass}}-markup"></div> </div> <div class="{{baseClass}}-content-plain-text" style="display: none"> <textarea class="{{baseClass}}-area {{baseClass}}-plain"></textarea> </div> <div class="{{baseClass}}-content-formatted-unclean" style="display: none"> <div contenteditable="true" class="{{baseClass}}-area {{baseClass}}-rich"></div> </div> <div class="{{baseClass}}-content-source" style="display: none"> <textarea class="{{baseClass}}-area {{baseClass}}-source"></textarea> </div> </div> </div>',"snippet-menu.item":'<li><a data-name="{{name}}">{{name}}</a></li>',"special-characters.dialog":"<div> tr('specialCharactersHelp') <br/> <ul></ul> </div>","special-characters.tab-button":'<button data-setKey="{{setKey}}" data-charactersIndex="{{charactersIndex}}" title="{{description}}">{{htmlEntity}}</button>',"special-characters.tab-content":'<div id="{{baseClass}}-{{key}}"></div>',"special-characters.tab-li":'<li><a href="#{{baseClass}}-{{key}}">{{name}}</a></li>',"table.create-menu":'<table class="{{baseClass}}-menu"> <tr> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> <tr> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> <tr> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> <tr> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> <tr> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> <tr> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> <tr> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> <tr> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> </table>',"tag-menu.menu":"<li><a data-value=\"na\">tr('tagMenuTagNA')</a></li> <li><a data-value=\"p\">tr('tagMenuTagP')</a></li> <li><a data-value=\"h1\">tr('tagMenuTagH1')</a></li> <li><a data-value=\"h2\">tr('tagMenuTagH2')</a></li> <li><a data-value=\"h3\">tr('tagMenuTagH3')</a></li> <li><a data-value=\"h4\">tr('tagMenuTagH4')</a></li> <li><a data-value=\"div\">tr('tagMenuTagDiv')</a></li> <li><a data-value=\"pre\">tr('tagMenuTagPre')</a></li> <li><a data-value=\"address\">tr('tagMenuTagAddress')</a></li>","unsaved-edit-warning.warning":'<div class="{{baseClass}} ui-corner-tl"> <span class="ui-icon ui-icon-alert"></span> <span>tr(\'unsavedEditWarningText\')</span> </div>',"view-source.dialog":'<div class="{{baseClass}}-inner-wrapper"> <textarea></textarea> </div>'};
e("en","English",{alignCenterTitle:"Align text center",alignJustifyTitle:"Align text justify",alignLeftTitle:"Align text left",alignRightTitle:"Align text right",cancelDialogCancelButton:"Continue Editing",cancelDialogContent:"Are you sure you want to cancel editing? All changes will be lost!",cancelDialogOKButton:"Cancel Editing",cancelDialogTitle:"Cancel Editing",cancelTitle:"Cancel editing",classMenuTitle:"Style picker",cleanBlockTitle:"Clean block",clearFormattingTitle:"Clear formatting",clickButtonToEditText:"Edit",clickButtonToEditTitle:null,closeTitle:"Close this toolbar",colorMenuBasicAutomatic:"Automatic",colorMenuBasicBlack:"Black",colorMenuBasicBlue:"Blue",colorMenuBasicGreen:"Green",colorMenuBasicGrey:"Grey",colorMenuBasicOrange:"Orange",colorMenuBasicPurple:"Purple",colorMenuBasicRed:"Red",colorMenuBasicTitle:"Change text color",colorMenuBasicWhite:"White",dockToElementTitle:"Dock/undock editor to element",dockToScreenTitle:"Dock/undock editor to screen",embedTitle:"Embed object",embedDialogTitle:"Embed Object",embedDialogTabCode:"Embed Code",embedDialogTabCodeContent:"Paste your embed code into the text area below:",embedDialogTabPreview:"Preview",embedDialogTabPreviewContent:"A preview of your embedded object is displayed below:",embedDialogOKButton:"Embed Object",embedDialogCancelButton:"Cancel",errorUINoName:'UI "{{ui}}" is invalid (must have a name property)',errorUINotObject:'UI "{{ui}}" is invalid (must be an object)',errorUIOverride:'UI "{{name}}" has already been registered, and will be overwritten',editPageDialogTitle:"Edit Page",editPageDialogOKButton:"Save",editPageDialogCancelButton:"Cancel",floatLeftTitle:"Align image to the left",floatNoneTitle:"Remove image align",floatRightTitle:"Align image to the right",fontFamilyMenuTitle:"Choose your font",fontFamilyMenuFontDefault:"Default Font",fontFamilyMenuFontArial:"Arial",fontFamilyMenuFontPalatino:"Palatino",fontFamilyMenuFontGeorgia:"Georgia",fontFamilyMenuFontTimes:"Times New Roman",fontFamilyMenuFontComicSans:"Comic Sans",fontFamilyMenuFontImpact:"Impact",fontFamilyMenuFontCourier:"Courier New",guidesTitle:"Show element guides",historyRedoTitle:"Redo",historyUndoTitle:"Undo",hrCreateTitle:"Insert Horizontal Rule",imageResizeDialogWidth:"Image width",imageResizeDialogHeight:"Image height",imageResizeDialogWidthPlaceHolder:"Width",imageResizeDialogHeightPlaceHolder:"Height",imageResizeDialogTitle:"Resize Image",imageResizeDialogOKButton:"Resize",imageResizeDialogCancelButton:"Cancel",imageResizeTitle:"Resize this image",insertFileTitle:"Insert file",insertFileDialogTitle:"Insert file",insertFileDialogOKButton:"Insert file",insertFileDialogCancelButton:"Cancel",insertFileURLLabel:"File URL",insertFileNameLabel:"File Name",insertFileURLPlaceHolder:"File URL...",insertFileNamePlaceHolder:"File Name...",languageMenuTitle:"Change Language",loremIpsumTitle:"Insert dummy text for testing",listOrderedTitle:"Ordered list",listUnorderedTitle:"Unordered list",linkCreateTitle:"Insert Link",linkRemoveTitle:"Remove Link",linkCreateDialogTitle:"Insert Link",linkCreateDialogOKButton:"Insert Link",linkCreateDialogCancelButton:"Cancel",linkCreateDialogMenuHeader:"Choose a link type",linkTypeEmailLabel:"Email address",linkTypeEmailHeader:"Link to an email address",linkTypeEmailToLabel:"Email:",linkTypeEmailToPlaceHolder:"Enter email address",linkTypeEmailSubjectLabel:"Subject (optional):",linkTypeEmailSubjectPlaceHolder:"Enter subject",linkTypeExternalLabel:"Page on another website",linkTypeExternalHeader:"Link to a page on another website",linkTypeExternalLocationLabel:"Location:",linkTypeExternalLocationPlaceHolder:"Enter a URL",linkTypeExternalNewWindowHeader:"New window",linkTypeExternalNewWindowLabel:"Check this box to have the link open in a new browser window/tab.",linkTypeExternalInfo:"<h2>Not sure what to put in the box above?</h2><ol>    <li>Find the page on the web you want to link to.</li>    <li>Copy the web address from your browser's address bar and paste it into the box above.</li></ol>",linkTypeDocumentLabel:"Document or other file",linkTypeDocumentHeader:"Link to a document or other file",linkTypeDocumentLocationLabel:"Location:",linkTypeDocumentLocationPlaceHolder:"Enter a URL",linkTypeDocumentNewWindowHeader:"New window",linkTypeDocumentNewWindowLabel:"Check this box to have the file open in a new browser window/tab.",linkTypeDocumentInfo:"<h2>Not sure what to put in the box above?</h2><ol>    <li>Ensure the file has been uploaded to your website.</li>    <li>Open the uploaded file in your browser.</li>    <li>Copy the file's URL from your browser's address bar and paste it into the box above.</li></ol>",linkTypeInternalLabel:"Page on this website",linkTypeInternalHeader:"Link to a page on this website",linkTypeInternalLocationLabel:"",linkTypeInternalLocationPlaceHolder:"Enter a URI",linkTypeInternalNewWindowHeader:"New window",linkTypeInternalNewWindowLabel:"Check this box to have the link open in a new browser window/tab.",linkTypeInternalInfo:'<h2>Not sure what to put in the box above?</h2><ol>    <li>Find the page on this site link to.</li>    <li>Copy the web address from your browser\'s address bar, excluding "{{domain}}" and paste it into the box above.</li></ol>',logoTitle:"Learn More About the Raptor WYSIWYG Editor",navigateAway:"\nThere are unsaved changes on this page. \nIf you navigate away from this page you will lose your unsaved changes",pasteDialogTitle:"Paste",pasteDialogOKButton:"Insert",pasteDialogCancelButton:"Cancel",pasteDialogPlain:"Plain Text",pasteDialogFormattedCleaned:"Formatted &amp; Cleaned",pasteDialogFormattedUnclean:"Formatted Unclean",pasteDialogSource:"Source Code",placeholderPluginDefaultContent:"<br/>",saveTitle:"Save content",saveNotConfigured:"Save has not been configured, or is disabled.",saveJsonFail:"Failed to save {{failed}} content block(s)",saveJsonSaved:"Successfully saved {{saved}} content block(s).",saveRestFail:"Failed to save {{failed}} content block(s).",saveRestPartial:"Saved {{saved}} out of {{failed}} content blocks.",saveRestSaved:"Successfully saved {{saved}} content block(s).",snippetMenuTitle:"Snippets",specialCharactersArrows:"Arrows",specialCharactersDialogOKButton:"OK",specialCharactersDialogTitle:"Insert Special Characters",specialCharactersGreekAlphabet:"Greek Alphabet",specialCharactersHelp:'Click a special character to add it. Click "OK" when done to close this dialog',specialCharactersMathematics:"Mathematics",specialCharactersSymbols:"Symbols",specialCharactersTitle:"Insert a special character",statisticsButtonCharacterOverLimit:"{{charactersRemaining}} characters over limit",statisticsButtonCharacterRemaining:"{{charactersRemaining}} characters remaining",statisticsButtonCharacters:"{{characters}} characters",statisticsDialogCharactersOverLimit:"{{characters}} characters, {{charactersRemaining}} over the recommended limit",statisticsDialogCharactersRemaining:"{{characters}} characters, {{charactersRemaining}} remaining",statisticsDialogNotTruncated:"Content will not be truncated",statisticsDialogOKButton:"Ok",statisticsDialogSentence:"{{sentences}} sentence",statisticsDialogSentences:"{{sentences}} sentences",statisticsDialogTitle:"Content Statistics",statisticsDialogTruncated:"Content contains more than {{limit}} characters and may be truncated",statisticsDialogWord:"{{words}} word",statisticsDialogWords:"{{words}} words",statisticsTitle:"Click to view statistics",imageSwapTitle:"Swap this image",tableCreateTitle:"Create table",tableDeleteColumnTitle:"Delete table column",tableDeleteRowTitle:"Delete table row",tableInsertColumnTitle:"Insert table column",tableInsertRowTitle:"Insert table row",tableMergeCellsTitle:"Merge table cells",tableSplitCellsTitle:"Split table cells",tagMenuTagH1:"Heading&nbsp;1",tagMenuTagH2:"Heading&nbsp;2",tagMenuTagH3:"Heading&nbsp;3",tagMenuTagH4:"Heading&nbsp;4",tagMenuTagNA:"N/A",tagMenuTagP:"Paragraph",tagMenuTagDiv:"Div",tagMenuTagPre:"Pre-formatted",tagMenuTagAddress:"Address",tagMenuTitle:"Change element style",tagTreeElementLink:"Select {{element}} element",tagTreeElementTitle:'Click to select the contents of the "{{element}}" element',tagTreeRoot:"root",tagTreeRootLink:"Select all editable content",tagTreeRootTitle:"Click to select all editable content",textBlockQuoteTitle:"Block quote",textBoldTitle:"Bold",textItalicTitle:"Italic",textStrikeTitle:"Strike through",textSubTitle:"Sub-script",textSuperTitle:"Super-script",textUnderlineTitle:"Underline",textSizeDecreaseTitle:"Decrease text size",textSizeIncreaseTitle:"Increase text size",unsavedEditWarningText:"There are unsaved changes on this page",revisionsText:"Revisions",revisionsTextEmpty:"No Revisions",revisionsTitle:null,revisionsCreated:"Created",revisionsApplyButtonTitle:"Rollback",revisionsApplyButtonText:"Rollback",revisionsAJAXFailed:"Failed to retrieve revisions",revisionsApplyButtonDialogCancelButton:"Cancel",revisionsApplyButtonDialogOKButton:"Rollback",revisionsApplyButtonDialogTitle:"Rollback Confirmation",revisionsApplyDialogContent:"This will replace the current content with the selected revision.<br/>The current content will be added as a revision, and will be visible in the revisions list for this block.",revisionsDialogCancelButton:"Cancel",revisionsDialogTitle:"View content revisions",revisionsButtonCurrent:"Current",revisionsButtonViewDiffText:"Differences",revisionsButtonViewDiffTitle:null,revisionsDiffButtonDialogCancelButton:"Close",revisionsDiffButtonDialogTitle:"View differences",revisionsDiffButtonTitle:"View differences",revisionsDiffButtonText:"View differences",revisionsLoading:"Loading revisions...",revisionsNone:"No revisions for this element",revisionsPreviewButtonTitle:"Preview",revisionsPreviewButtonText:"Preview",fileManagerDialogTitle:"File Manager",fileManagerTitle:"File Manager",rfmClose:"Close",rfmContinue:"Continue",rfmDeleteTitle:"Delete",rfmDownloadTitle:"Download",rfmEditTitle:"Edit",rfmFileActions:"Actions",rfmFileModificationTime:"Modified",rfmFileName:"Name",rfmFileSize:"Size",rfmFileType:"Type",rfmFilteredTotal:"Showing {{start}} to {{end}} of {{filteredTotal}} files",rfmFirst:"First",rfmHeadingDirectories:"Directories",rfmHeadingSearch:"Search",rfmHeadingTags:"Tags",rfmHeadingUpload:"Upload",rfmInsertTitle:"Insert",rfmLast:"Last",rfmRenameTitle:"Rename",rfmSearch:"Go",rfmTagDocument:"Document",rfmTagImage:"Image",rfmTotal:", filtered from {{total}}",rfmUpload:"Upload",rfmUploadBrowse:"Browse",rfmUploadDrop:"Drop Files Here",rfmUploadFileRemove:"Remove",rfmUploadOr:"or",rfmViewTitle:"View",imageEditorDialogCancelButton:"Cancel",imageEditorDialogOKButton:"Save",imageEditorDialogTitle:"Image Editor",imageEditorTitle:"Edit Image",rieApply:"Apply",rieBlurTitle:"Blur",rieBrightnessTitle:"Brightness/Contrast",rieCancel:"Cancel",rieCancelTitle:"Cancel",rieColorAdjustTitle:"Adjsut Color",rieCropTitle:"Crop",rieDesaturateTitle:"Desaturate",rieFlipHTitle:"Flip Horizontally",rieFlipVTitle:"Flip Vertically",rieGlowTitle:"Glow",rieHslTitle:"Hue, Saturation, Lightness.",rieInvertTitle:"Invert",riePosterizeTitle:"Posterize",rieRedoTitle:"Redo",rieRemoveNoiseTitle:"Remove Noise",rieResizeTitle:"Resize",rieRevertTitle:"Revert",rieRotateLeftTitle:"Rotate Left",rieRotateRightTitle:"Rotate Right",rieSaveTitle:"Save",rieSaveTitle:"Save",rieSepiaTitle:"Sepia",rieSharpenTitle:"Sharpen",rieSolarizeTitle:"Solarize",rieUndoTitle:"Undo",rieUploadTitle:"Upload",rieActionColorAdjustRed:"Red",rieActionColorAdjustGreen:"Green",rieActionColorAdjustBlue:"Blue",rieActionBrightnessBrightness:"Brightness",rieActionBrightnessContrast:"Contrast",rieActionGlowAmount:"Glow Amount",rieActionGlowRadius:"Glow Radius",rieActionHsl:"Hue",rieActionHsl:"Saturation",rieActionHsl:"Lightness",rieActionPosterize:"Levels",viewSourceDialogCancelButton:"Close",viewSourceDialogOKButton:"Apply source code",viewSourceDialogTitle:"Content source code",viewSourceTitle:"View/edit source code"});var Xn=!1,Kn=jQuery;Kn(function(){rangy.initialized||rangy.init(),Kn.isFunction(rangy.rangePrototype.insertNodeAtEnd)||(rangy.rangePrototype.insertNodeAtEnd=function(t){var e=this.cloneRange();e.collapse(!1),e.insertNode(t),e.detach(),this.setEndAfter(t)})}),Kn("html").click(function(){Kn(".ui-editor-selectmenu-visible").removeClass("ui-editor-selectmenu-visible")});var _n,Qn,Jn,$n,Yn;Object.create||(Object.create=function(t){function e(){}if(arguments.length>1)throw new Error("Object.create implementation only accepts the first parameter.");return e.prototype=t,new e}),"undefined"==typeof Node&&(Node={TEXT_NODE:3}),"".trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")});var Zn={globalDefaults:{},defaults:{},enableHotkeys:!0,hotkeys:{},plugins:{},ui:{},layouts:{},presets:{},hoverPanels:{},instances:[],getInstances:function(){return this.instances},eachInstance:function(t){for(var e=0;e<this.instances.length;e++)t.call(this.instances[e],this.instances[e])},urlPrefix:"/raptor/",getTemplate:function(t,e){var i;if(this.templates[t])i=this.templates[t];else{var n=e||this.urlPrefix,o=t.split(".");n+=1===o.length?"templates/"+o[0]+".html":"plugins/"+o[0]+"/templates/"+o.splice(1).join("/")+".html",Kn.ajax({url:n,type:"GET",async:!1,timeout:15e3,error:function(){i=null},success:function(t){i=t}}),this.templates[t]=i}return i},isDirty:function(){for(var t=this.getInstances(),e=0;e<t.length;e++)if(t[e].isDirty())return!0;return!1},unloadWarning:function(){for(var t=this.getInstances(),e=0;e<t.length;e++)if(t[e].isDirty()&&t[e].isEditing()&&t[e].options.unloadWarning)return a("navigateAway")},registerUi:function(t){this.ui[t.name]=t},registerLayout:function(t){this.layouts[t.name]=t},registerPlugin:function(t){this.plugins[t.name]=t},registerPreset:function(t,e){this.presets[t.name]=t,e&&(this.defaults=t)},persist:function(t,e,i){t=i?i+"."+t:t;try{if(localStorage){var n;if(n=localStorage.uiWidgetEditor?JSON.parse(localStorage.uiWidgetEditor):{},void 0===e)return n[t];n[t]=e,localStorage.uiWidgetEditor=JSON.stringify(n)}}catch(o){}return e}},to=!1,eo={_init:function(){if(!this.element.attr("data-raptor-initialised")){this.element.attr("data-raptor-initialised",!0),-1===Kn.inArray(this,Zn.instances)&&Zn.instances.push(this);var t=this,e=this.persist("locale")||this.options.initialLocale;e&&(jn=e);var i=this.options;this.options=this.options.preset?Kn.extend(!0,{},Zn.globalDefaults,Zn.presets[this.options.preset],this.options):Kn.extend(!0,{},Zn.globalDefaults,Zn.defaults,this.options),i.layouts&&i.layouts.toolbar&&i.layouts.toolbar.uiOrder&&(this.options.layouts.toolbar.uiOrder=i.layouts.toolbar.uiOrder),this.element.attr("id")||this.element.attr("id",be()),this.ready=!1,this.events={},this.plugins={},this.layouts={},this.templates=Kn.extend({},Zn.templates),this.target=this.element,this.layout=null,this.previewState=null,this.pausedState=null,this.pausedScrollX=null,this.pausedScrollY=null,this.enabled=!1,this.initialised=!1,this.uiObjects={},this.hotkeys={},this.hotkeysSuspended=!1,this.options.enableHotkeys&&this.registerHotkey(this.hotkeys);for(var n in this.options.bind)this.bind(n,this.options.bind[n]);this.history=[],this.present=0,this.historyEnabled=!0,en()&&(this.setOriginalHtml(this.element.is(":input")?this.element.val():this.element.html()),this.historyPush(this.getOriginalHtml()),this.element.is(":input")&&this.replaceOriginal(),this.loadPlugins(),this.dirty=!1,this.previousContent=null,this.previousSelection=null,this.getElement().addClass("raptor-editable-block"),this.loadLayouts(),this.ready=!0,this.fire("ready"),this.options.autoEnable&&Kn(function(){t.enableEditing()}))}},attach:function(){this.bind("change",this.historyPush),this.getElement().on("click.raptor","img",function(t){ei(t.target),this.checkSelectionChange()}.bind(this)),this.getElement().on("focus.raptor",this.showLayout.bind(this)),this.target.on("mouseup.raptor",this.checkSelectionChange.bind(this)),this.target.on("input.raptor",this.checkChange.bind(this)),Kn(window).bind("beforeunload",Zn.unloadWarning.bind(Zn));var t=this;Kn(window).resize(function(){t.fire("resize")})},detach:function(){this.unbind("change"),this.getElement().off("click.raptor","img"),this.getElement().off("focus.raptor"),this.getElement().blur(),this.target.off("mouseup.raptor"),this.target.off("keyup.raptor")},localeChange:function(){if(!this.ready){var t;return t=function(){this.unbind("ready",t),this.localeChange()},this.bind("ready",t),void 0}this.actionPreviewRestore();var e=[];for(var i in this.layouts)this.layouts[i].isVisible()&&e.push(i);this.layoutsDestruct(),this.events={},this.plugins={},this.uiObjects={},this.hotkeys={},this.loadPlugins(),this.loadLayouts();for(var n=0;n<e.length;n++)this.layouts[e[n]].show();this.checkSelectionChange()},restoreFocus:function(){this.getElement().focus()},getElement:function(){return this.target},getNode:function(){return this.target[0]},getOriginalElement:function(){return this.element},replaceOriginal:function(){if(this.target.is(":input")){for(var t=Kn("<div/>").html(this.element.val()).insertBefore(this.element).attr("id",be()).addClass(this.element.attr("class")).addClass(this.options.classes),e=ce(this.element),i=0;i<this.options.replaceStyle.length;i++)t.css(this.options.replaceStyle[i],e[this.options.replaceStyle[i]]);this.element.hide(),this.bind("change",function(){this.getOriginalElement().is(":input")?this.getOriginalElement().val(this.getHtml()).trigger("input"):this.getOriginalElement().html(this.getHtml())}),this.target=t}},checkSelectionChange:function(){var t=rangy.serializeSelection(null,!1);this.previousSelection!==t&&this.fire("selectionChange"),this.previousSelection=t},checkChange:function(){var t=this.getHtml(),e=this.dirty;this.dirty=this.originalHtml!==t,this.previousHtml!==t&&(this.previousHtml=t,this.fire("change",[t]),e!==this.dirty&&(this.dirty?this.fire("dirty"):this.fire("cleaned")),this.checkSelectionChange())},change:function(){this.fire("change",[this.getHtml()])},destruct:function(){this.disableEditing(),this.fire("destroy"),this.events={},this.getElement().off(".raptor"),this.getOriginalElement().is(":input")&&(this.target.remove(),this.target=null,this.element.show()),this.layoutsDestruct()},actionPreview:function(t){this.actionPreviewRestore();try{var e=this.fire("selectionCustomise");e.length>0?this.previewState=M(this.previewState,this.target,function(){for(var i=0,n=e.length;n>i;i++)rangy.getSelection().setSingleRange(e[i]),this.selectionConstrain(),t()}.bind(this)):(this.selectionConstrain(),this.previewState=M(this.previewState,this.target,t)),this.checkSelectionChange()}catch(i){}},actionPreviewRestore:function(){this.previewState&&(this.target=H(this.previewState,this.target),this.previewState=null,this.checkSelectionChange())},actionApply:function(t){this.actionPreviewRestore();var e=this.stateSave();try{var i=this.fire("selectionCustomise");i.length>0?L(function(){for(var e=0,n=i.length;n>e;e++)rangy.getSelection().setSingleRange(i[e]),this.selectionConstrain(),L(t,this.history)}.bind(this),this.history):(this.selectionConstrain(),L(t,this.history)),this.checkChange()}catch(n){this.stateRestore(e)}},actionUndo:function(){},actionRedo:function(){},stateSave:function(){return this.selectionConstrain(),Ii(this.target)},stateRestore:function(t){var e=Oi(this.target,t),i=rangy.getSelection();this.target=e.element,null!==e.ranges&&(i.setRanges(e.ranges),i.refresh())},selectionConstrain:function(){ki(this.target[0])},pause:function(){this.pausedState||(this.pausedState=this.stateSave(),this.suspendHotkeys(),this.pausedScrollX=window.scrollX,this.pausedScrollY=window.scrollY)},resume:function(){this.pausedState&&(this.stateRestore(this.pausedState),this.pausedState=null,this.resumeHotkeys(),this.restoreFocus(),window.scrollTo(this.pausedScrollX,this.pausedScrollY))},persist:function(t,e){return this.options.persistence?Zn.persist(t,e,this.options.namespace):null},enableEditing:function(){if(!this.enabled){if(this.fire("enabling"),this.attach(),this.enabled=!0,this.getElement().addClass(this.options.baseClass+"-editing").addClass(this.options.classes),this.options.partialEdit?this.getElement().find(this.options.partialEdit).prop("contenteditable",!0):this.getElement().prop("contenteditable",!0),!this.initialised){this.initialised=!0;for(var t in this.plugins)this.plugins[t].enable();this.bindHotkeys(),this.getElement().closest("form").on("submit.raptor",function(){K(this.getElement()),this.fire("change",[this.getHtml()])}.bind(this))}K(this.getElement()),this.fire("enabled"),this.showLayout();var e=this.options.partialEdit?this.getElement().find("[contenteditable]")[0]:this.getNode();switch(this.options.autoSelect){case"all":ti(e);break;case"start":var i=Kn(e).find("*:first")[0];if(!i){ti(e);break}var n=rangy.createRange();n.setStartBefore(i),n.setEndBefore(i),Ye(n);break;case"end":var i=Kn(e).find("*:last")[0];if(!i){ti(e);break}ti(i);var n=rangy.createRange();n.setStartAfter(i),n.setEndAfter(i),Ye(n)}}},disableEditing:function(){this.enabled&&(this.detach(),this.enabled=!1,this.getElement().prop("contenteditable",!1).removeClass(this.options.baseClass+"-editing").removeClass(this.options.classes),rangy.getSelection().removeAllRanges(),this.fire("disabled"),this.options.reloadOnDisable&&!to&&(to=!0,window.location.reload()))},cancelEditing:function(){this.unify(function(t){t.stopEditing()})},stopEditing:function(){this.fire("cancel"),this.options.reloadOnDisable||this.resetHtml(),this.disableEditing(),this.dirty=!1,Qe()},isEditing:function(){return this.enabled},isRoot:function(t){return this.getElement()[0]===Kn(t)[0]},unify:function(t,e){if(e!==!1&&t(this),this.options.unify){var i=this;Zn.eachInstance(function(e){e!==i&&e.options.unify&&t(e)})}},getLayout:function(t){return this.layouts[t]},loadLayouts:function(){for(var t in this.options.layouts)"undefined"!=typeof Zn.layouts[t]&&(this.layouts[t]=this.prepareComponent(Zn.layouts[t],this.options.layouts[t],"layout").instance,this.layouts[t].hotkeys&&this.registerHotkey(this.layouts[t].hotkeys,null,this.layouts[t]))},layoutsDestruct:function(){for(var t in this.layouts)this.layouts[t].destruct()},prepareComponent:function(t,e,i){var n=Kn.extend({},t),o=Kn.extend({},this.options,{baseClass:this.options.baseClass+"-"+i+"-"+p(t.name)},n.options,e);n.raptor=this,n.options=o;var a=n.init();return{init:a,instance:n}},showLayout:function(){this.unify(function(t){t.fire("layoutHide")},!1),this.fire("layoutShow"),this.fire("resize"),"undefined"==typeof this.getElement().attr("tabindex")&&this.getElement().attr("tabindex",-1)},getTemplate:function(t,e){return this.templates[t]||(this.templates[t]=u(t,this.options.urlPrefix)),d(this.templates[t],e)},historyPush:function(){if(this.historyEnabled){var t=this.getHtml();t!==this.historyPeek()&&(this.present!==this.history.length-1&&(this.history=this.history.splice(0,this.present+1)),this.history.push(this.getHtml()),this.present=this.history.length-1,this.fire("historyChange"))}},historyPeek:function(){return this.history.length?this.history[this.present]:null},historyBack:function(){this.present>0&&(this.present--,this.setHtml(this.history[this.present]),this.historyEnabled=!1,this.change(),this.historyEnabled=!0,this.fire("historyChange"))},historyForward:function(){this.present<this.history.length-1&&(this.present++,this.setHtml(this.history[this.present]),this.historyEnabled=!1,this.change(),this.historyEnabled=!0,this.fire("historyChange"))},registerHotkey:function(t,e){this.hotkeys[t]=e},bindHotkeys:function(){for(var t in this.hotkeys)this.getElement().on("keydown.raptor",t,function(t){if(this.isEditing()&&!this.hotkeysSuspended){var e=this.hotkeys[t.data]();e!==!1&&t.preventDefault()}}.bind(this))},suspendHotkeys:function(){this.hotkeysSuspended=!0},resumeHotkeys:function(){this.hotkeysSuspended=!1},isUiEnabled:function(t){return this.options.enableUi===!1&&"undefined"==typeof this.options.plugins[t]||this.options.plugins[t]===!1?!1:-1!==Kn.inArray(t,this.options.disabledUi)||-1!==Kn.inArray(t,this.options.disabledPlugins)?!1:!0},getUi:function(t){return this.uiObjects[t]},getPlugin:function(t){return this.uiObjects[t]||this.plugins[t]},loadPlugins:function(){var t=this;this.options.plugins||(this.options.plugins={});for(var e in Zn.plugins)this.options.enablePlugins===!1&&"undefined"==typeof this.options.plugins[e]||this.options.plugins[e]===!1||-1===Kn.inArray(e,this.options.disabledUi)&&-1===Kn.inArray(e,this.options.disabledPlugins)&&(t.plugins[e]=this.prepareComponent(Zn.plugins[e],t.options.plugins[e],"plugin").instance)},isDirty:function(){return this.dirty},getHtml:function(){return this.getElement().html()},clean:function(){this.actionApply(function(){K(this.getElement())}.bind(this))},setHtml:function(t){this.getElement().html(t),this.fire("html"),this.checkChange()},resetHtml:function(){this.setHtml(this.getOriginalHtml()),this.fire("cleaned")},getOriginalHtml:function(){return this.originalHtml},saved:function(t){this.setOriginalHtml(this.getHtml()),this.dirty=!1,this.fire("saved",t),this.fire("cleaned")},setOriginalHtml:function(t){this.originalHtml=t},bind:function(t,e,i){if("undefined"!=typeof e&&Kn.isFunction(e))for(var n=t.split(/,\s*/),o=0,a=n.length;a>o;o++)this.events[n[o]]||(this.events[n[o]]=[]),this.events[n[o]].push({context:i,callback:e})},unbind:function(t,e,i){for(var n=0,o=this.events[t].length;o>n;n++)this.events[t][n]&&this.events[t][n].callback===e&&this.events[t][n].context===i&&this.events[t].splice(n,1)},fire:function(t,e){var i=[];if(this.events[t])for(var n=0,o=this.events[t].length;o>n;n++){var a=this.events[t][n];if("undefined"!=typeof a&&"undefined"!=typeof a.callback){var s=a.callback.apply(a.context||this,e);"undefined"!=typeof s&&(i=i.concat(s))}}return i}};Kn.widget("ui.raptor",eo),Kn.fn.raptor.Raptor=Zn,nn.prototype.init=function(){},nn.prototype.destruct=function(){},nn.prototype.isVisible=function(){return!1},nn.prototype.show=function(){},nn.prototype.hide=function(){},on.prototype.init=function(){},on.prototype.enable=function(){},an.prototype.appendTo=function(t,e){for(var i=0,n=this.uiOrder.length;n>i;i++){for(var o=Kn("<div/>").addClass(this.raptor.options.baseClass+"-layout-toolbar-group"),a=this.uiOrder[i],s=0,r=a.length;r>s;s++)if(this.raptor.isUiEnabled(a[s])&&Zn.ui[a[s]]){var l=this.raptor.options.plugins[a[s]];if(l===!1)continue;var c=this.raptor.prepareComponent(Zn.ui[a[s]],l,"ui");c.instance.layout=t,this.raptor.uiObjects[a[s]]=c.instance,C(c.init)&&(c.init.removeClass("ui-corner-all"),o.append(c.init))}o.children().length>0&&o.appendTo(e)}e.find(".ui-button:first-child").addClass("ui-corner-left"),e.find(".ui-button:last-child").addClass("ui-corner-right")},sn.prototype=Object.create(nn.prototype),sn.prototype.init=function(){this.raptor.bind("enabled",this.show.bind(this)),this.raptor.bind("disabled",this.hide.bind(this)),this.raptor.bind("layoutShow",this.show.bind(this)),this.raptor.bind("layoutHide",this.hide.bind(this)),Kn(window).resize(this.constrainPosition.bind(this))},sn.prototype.destruct=function(){this.wrapper&&(this.wrapper.remove(),this.wrapper=null),this.raptor.fire("toolbarDestroy")},sn.prototype.show=function(){this.isVisible()||(this.getElement().css("display",""),this.constrainPosition(),this.raptor.getElement().zIndex()>this.getElement().zIndex()?this.getElement().css("z-index",this.raptor.getElement().zIndex()+1):this.getElement().css("z-index",null),this.raptor.fire("toolbarShow"))},sn.prototype.hide=function(){this.isReady()&&(this.getElement().css("display","none"),this.raptor.fire("toolbarHide"))},sn.prototype.initDragging=function(){if(Kn.fn.draggable&&this.options.draggable&&!this.getElement().data("ui-draggable")){this.getElement().draggable({cancel:"a, button",cursor:"move",stop:this.constrainPosition.bind(this)}),this.getElement().css("position","fixed");var t=this.raptor.persist("position")||this.options.dialogPosition;t||(t=[10,10]),parseInt(t[0],10)+this.getElement().outerHeight()>Kn(window).height()&&(t[0]=Kn(window).height()-this.getElement().outerHeight()),parseInt(t[1],10)+this.getElement().outerWidth()>Kn(window).width()&&(t[1]=Kn(window).width()-this.getElement().outerWidth()),this.getElement().css({top:Math.abs(parseInt(t[0],10)),left:Math.abs(parseInt(t[1],10))})}},sn.prototype.enableDragging=function(){Kn.fn.draggable&&this.options.draggable&&this.getElement().data("ui-draggable")&&this.getElement().draggable("enable")},sn.prototype.disableDragging=function(){Kn.fn.draggable&&this.options.draggable&&this.getElement().is(".ui-draggable")&&this.getElement().draggable("disable").removeClass("ui-state-disabled")},sn.prototype.isReady=function(){return null!==this.wrapper},sn.prototype.isVisible=function(){return this.isReady()&&this.getElement().is(":visible")},sn.prototype.constrainPosition=function(){if(this.isVisible()){var t=parseInt(this.wrapper.css("left"))||-999,e=parseInt(this.wrapper.css("top"))||-999,i=this.wrapper.outerWidth(),n=this.wrapper.outerHeight(),o=Kn(window).width(),a=Kn(window).height(),s=Math.max(0,Math.min(t,o-i)),r=Math.max(0,Math.min(e,a-n));(s!==t||r!==e)&&this.wrapper.css({left:s,top:r}),this.raptor.persist("position",[this.wrapper.css("top"),this.wrapper.css("left")])}},sn.prototype.getElement=function(){if(null===this.wrapper){if(!this.options.uiOrder){this.options.uiOrder=[[]];for(var t in Zn.ui)this.options.uiOrder[0].push(t)}var e=this.toolbar=Kn("<div/>").addClass(this.options.baseClass+"-toolbar"),i=this.toolbarWrapper=Kn("<div/>").addClass(this.options.baseClass+"-inner").addClass("ui-widget-content").mousedown(function(t){t.preventDefault()}).append(e),n=this.path=Kn("<div/>").addClass(this.options.baseClass+"-path").addClass("ui-widget-header"),o=this.wrapper=Kn("<div/>").addClass(this.options.baseClass+"-outer "+this.raptor.options.baseClass+"-layout").css("display","none").append(n).append(i),a=new an(this.raptor,this.options.uiOrder);a.appendTo(this,this.toolbar),Kn("<div/>").css("clear","both").appendTo(this.toolbar),Kn(function(){o.appendTo("body"),this.initDragging(),this.constrainPosition(!0),this.raptor.fire("layoutReady",[this.wrapper]),this.raptor.fire("toolbarReady",[this])}.bind(this))}return this.wrapper},Zn.registerLayout(new sn),rn.prototype=Object.create(nn.prototype),rn.prototype.init=function(){this.raptor.bind("ready",this.ready.bind(this)),this.raptor.bind("enabled",this.enabled.bind(this))},rn.prototype.ready=function(){this.raptor.getElement().mouseenter(this.show.bind(this)).mouseleave(this.hide.bind(this))},rn.prototype.enabled=function(){this.getElement().hide()},rn.prototype.getElement=function(){if(null===this.hoverPanel){this.hoverPanel=Kn("<div/>").addClass(this.raptor.options.baseClass+"-layout "+this.options.baseClass).mouseleave(this.hide.bind(this));var t=new an(this.raptor,this.options.uiOrder);t.appendTo(this,this.hoverPanel),Kn(window).bind("scroll",this.position.bind(this)),this.hoverPanel.appendTo("body"),this.raptor.fire("layoutReady",[this.hoverPanel])}return this.hoverPanel},rn.prototype.show=function(){this.raptor.isEditing()||(this.visible=!0,this.getElement().show(),this.raptor.getElement().zIndex()>this.getElement().zIndex()?this.getElement().css("z-index",this.raptor.getElement().zIndex()+1):this.getElement().css("z-index",null),this.position(),this.raptor.getElement().addClass(this.raptor.options.baseClass+"-editable-block-hover"))},rn.prototype.hide=function(t){this.visible&&t&&(Kn.contains(this.getElement().get(0),t.relatedTarget)||t.relatedTarget!==this.getElement().get(0)&&this.getElement().get(0)!==Kn(t.relatedTarget).parent().get(0)&&(Kn.contains(this.raptor.getElement().get(0),t.relatedTarget)||t.relatedTarget!==this.raptor.getElement().get(0)&&(this.visible=!1,this.getElement().hide(),this.raptor.getElement().removeClass(this.raptor.options.baseClass+"-editable-block-hover"))))},rn.prototype.position=function(){if(this.visible){var t=re(this.raptor.getElement());this.getElement().css({top:t.top+(t.height/2-this.getElement().outerHeight()/2),left:t.left+(t.width/2-this.getElement().outerWidth()/2)})
}},rn.prototype.destruct=function(){this.hoverPanel&&(this.hoverPanel.remove(),this.hoverPanel=null),this.visible=!1},Zn.registerLayout(new rn),ln.prototype=Object.create(nn.prototype),ln.prototype.init=function(){this.raptor.bind("ready",this.ready.bind(this))},ln.prototype.ready=function(){this.raptor.getElement().on("mouseenter",this.options.elements,this.show.bind(this)).on("mouseleave",this.options.elements,this.hide.bind(this))},ln.prototype.getElement=function(){if(null===this.hoverPanel){this.hoverPanel=Kn("<div/>").addClass(this.raptor.options.baseClass+"-layout raptor-layout-hover-panel "+this.options.baseClass).mouseleave(this.hide.bind(this));var t=new an(this.raptor,this.options.uiOrder);t.appendTo(this,this.hoverPanel),Kn(window).bind("scroll",this.position.bind(this)),this.hoverPanel.appendTo("body"),this.raptor.fire("layoutReady",[this.hoverPanel])}return this.hoverPanel},ln.prototype.show=function(t){this.enabled&&this.raptor.isEditing()&&(this.target=t.target,this.visible=!0,ve(this.getElement().show(),Kn(this.target)))},ln.prototype.hide=function(t){if(this.visible){if(t){if(Kn.contains(this.getElement().get(0),t.relatedTarget))return;if(t.relatedTarget===this.getElement().get(0))return;if(this.getElement().get(0)===Kn(t.relatedTarget).parent().get(0))return;if(Kn.contains(this.raptor.getElement().get(0),t.relatedTarget))return;if(t.relatedTarget===this.raptor.getElement().get(0))return}this.visible=!1,this.getElement().hide()}},ln.prototype.close=function(){this.visible&&(this.enabled=!1,this.visible=!1,this.getElement().hide(),setTimeout(function(){this.enabled=!0}.bind(this),1e3))},ln.prototype.position=function(){this.visible&&ve(this.getElement(),Kn(this.target))},ln.prototype.destruct=function(){this.hoverPanel&&(this.hoverPanel.remove(),this.hoverPanel=null),this.visible=!1},Zn.registerLayout(new ln),cn.prototype.init=function(){if("string"==typeof this.hotkey)this.raptor.registerHotkey(this.hotkey,this.action.bind(this));else if(b(this.hotkey))for(var t=0,e=this.hotkey.length;e>t;t++)this.raptor.registerHotkey(this.hotkey[t],this.action.bind(this));return this.getButton()},cn.prototype.getButton=function(){if(!this.button){var t=this.text||this.translate("Text",!1);this.button=Kn("<div>").html(t).addClass(this.options.baseClass).attr("title",this.getTitle()).click(this.click.bind(this)),w(this.button,{icons:{primary:this.getIcon()},text:t,label:this.label})}return this.button},cn.prototype.getTitle=function(){return this.title||this.translate("Title")},cn.prototype.getIcon=function(){return null===this.icon?"ui-icon-"+p(this.name):this.icon},cn.prototype.click=function(){S(this.button)&&this.raptor.actionApply(this.action.bind(this))},cn.prototype.translate=function(t,e){return a(this.name+t,e)},pn.prototype=Object.create(cn.prototype),pn.prototype.init=function(){return this.preview="undefined"==typeof this.options.preview?!0:!1,cn.prototype.init.apply(this,arguments)},pn.prototype.getButton=function(){return this.button||(this.button=cn.prototype.getButton.call(this).mouseenter(this.mouseEnter.bind(this)).mouseleave(this.mouseLeave.bind(this))),this.button},pn.prototype.mouseEnter=function(){this.canPreview()&&(this.previewing=!0,this.raptor.actionPreview(this.action.bind(this)))},pn.prototype.mouseLeave=function(){this.previewing=!1,this.raptor.actionPreviewRestore()},pn.prototype.click=function(){return this.previewing=!1,cn.prototype.click.apply(this,arguments)},pn.prototype.canPreview=function(){return this.preview},pn.prototype.isPreviewing=function(){return this.previewing},hn.prototype=Object.create(cn.prototype),hn.prototype.init=function(){return this.raptor.bind("selectionChange",this.selectionChange.bind(this)),cn.prototype.init.apply(this,arguments)},hn.prototype.selectionChange=function(){this.selectionToggle()?(D(this.button),this.disable&&E(this.button)):(R(this.button),this.disable&&x(this.button))},un.prototype=Object.create(pn.prototype),un.prototype.init=function(){return this.raptor.bind("selectionChange",this.selectionChange.bind(this)),pn.prototype.init.apply(this,arguments)},un.prototype.selectionChange=function(){this.selectionToggle()?this.isPreviewing()||D(this.button):R(this.button)},dn.prototype=Object.create(pn.prototype),dn.prototype.init=function(){var t=pn.prototype.init.apply(this,arguments);return this.raptor.bind("selectionChange",this.selectionChange.bind(this)),t},dn.prototype.selectionChange=function(){this.isEnabled()?E(this.button):x(this.button)},dn.prototype.canPreview=function(){return pn.prototype.canPreview.call(this)&&this.isEnabled()},dn.prototype.isEnabled=function(){var t=Xe();return t?!!this.getElement(t):!!this.previewing},dn.prototype.action=function(){$e(function(t){var e=this.getElement(t);e&&this.applyToElement(e)}.bind(this))},gn.prototype=Object.create(un.prototype),gn.prototype.action=function(){xi(),this.raptor.selectionConstrain();for(var t=0,e=this.classes.length;e>t;t++){var i=rangy.createCssClassApplier(this.options.cssPrefix+this.classes[t],{elementTagName:this.tag||"span"});i.toggleSelection()}},gn.prototype.selectionToggle=function(){for(var t=0,e=this.classes.length;e>t;t++){var i=rangy.createCssClassApplier(this.options.cssPrefix+this.classes[t],{elementTagName:this.tag||"span"});if(!i.isAppliedToSelection())return!1}return!0};var io={};fn.prototype=Object.create(cn.prototype),fn.prototype.action=function(){this.openDialog()},fn.prototype.validateDialog=function(){return!0},fn.prototype.openDialog=function(){this.raptor.pause(),N(this.getDialog())},fn.prototype.onDialogClose=function(){io[this.name].instance.raptor.resume()},fn.prototype.okButtonClick=function(){var t=io[this.name].instance.validateDialog();t===!0&&(B(io[this.name].dialog),io[this.name].instance.applyAction.call(io[this.name].instance,io[this.name].dialog))},fn.prototype.closeDialog=function(){B(io[this.name].dialog)},fn.prototype.cancelButtonClick=fn.prototype.closeDialog,fn.prototype.getOkButton=function(t){return{text:a(t+"DialogOKButton"),click:this.okButtonClick.bind(this),icons:{primary:"ui-icon-circle-check"}}},fn.prototype.getCancelButton=function(t){return{text:a(t+"DialogCancelButton"),click:this.cancelButtonClick.bind(this),icons:{primary:"ui-icon-circle-close"}}},fn.prototype.getDefaultDialogOptions=function(t){var e={modal:!0,resizable:!0,autoOpen:!1,title:a(t+"DialogTitle"),dialogClass:this.options.baseClass+"-dialog "+this.options.dialogClass,close:this.onDialogClose.bind(this),buttons:[]},i=this.getOkButton(t),n=this.getCancelButton(t);return"undefined"!=typeof i&&i!==!1&&e.buttons.push(i),"undefined"!=typeof n&&n!==!1&&e.buttons.push(n),e},fn.prototype.getDialog=function(){return"undefined"==typeof io[this.name]&&(io[this.name]={dialog:Kn(this.getDialogTemplate())},A(io[this.name].dialog,Kn.extend(this.getDefaultDialogOptions(this.name),this.dialogOptions))),io[this.name].instance=this,io[this.name].dialog},mn.prototype=Object.create(fn.prototype),mn.prototype.init=hn.prototype.init,mn.prototype.selectionChange=hn.prototype.selectionChange,bn.prototype=Object.create(cn.prototype),bn.prototype.click=function(t){this.menu.getMenu().is(":visible")?Kn(".raptor-menu").hide():this.menu.show(),t.preventDefault()},yn.prototype.init=function(){this.setOptions();var t=this.getButton().init();return t.addClass("raptor-menu-button"),t},yn.prototype.getButton=function(){return this.button||(this.button=new bn(this)),this.button},yn.prototype.setOptions=function(){this.options.title=a(this.name+"Title"),this.options.icon="ui-icon-"+this.name},yn.prototype.getMenu=function(){return this.menu||(this.menu=Kn("<div>").addClass("ui-menu ui-widget ui-widget-content ui-corner-all "+this.options.baseClass+"-menu "+this.raptor.options.baseClass+"-menu").html(this.menuContent).css("position","fixed").hide().mousedown(function(t){t.preventDefault()}).children().appendTo("body")),this.menu},yn.prototype.show=function(){Kn(".raptor-menu").hide(),ge(this.getMenu().toggle(),this.getButton().getButton())},Kn("html").click(function(t){Kn(t.target).hasClass("raptor-menu-button")||0!==Kn(t.target).closest(".raptor-menu-button").length||Kn(".raptor-menu").hide()}),yn.prototype.getMenu=function(){return this.menu||(this.menu=Kn("<div>").addClass("ui-menu ui-widget ui-widget-content ui-corner-all "+this.options.baseClass+"-menu "+this.raptor.options.baseClass+"-menu").html(this.menuContent).css("position","fixed").hide().appendTo("body").mousedown(function(t){t.preventDefault()})),this.menu},vn.prototype=Object.create(yn.prototype),vn.prototype.menuItemMouseDown=function(t){t.preventDefault()},vn.prototype.menuItemClick=function(t){return T(this.button.button,Kn(t.target).html()),Kn(this.menu).closest("ul").hide(),!1},vn.prototype.menuItemMouseEnter=function(){},vn.prototype.menuItemMouseLeave=function(){},vn.prototype.getMenu=function(){return this.menu||(this.menu=Kn("<ul>").addClass(this.options.baseClass+"-menu "+this.raptor.options.baseClass+"-menu").html(this.getMenuItems()).css("position","fixed").hide().find("a").mousedown(this.menuItemMouseDown.bind(this)).mouseenter(this.menuItemMouseEnter.bind(this)).mouseleave(this.menuItemMouseLeave.bind(this)).click(this.menuItemClick.bind(this)).end().appendTo("body"),P(this.menu)),this.menu},Kn.extend(Zn,{Button:cn,CSSClassApplierButton:gn,DialogButton:fn,DialogToggleButton:mn,FilteredPreviewButton:dn,HoverPanelLayout:rn,Menu:yn,MenuButton:bn,PreviewButton:pn,PreviewToggleButton:un,RaptorLayout:nn,RaptorPlugin:on,SelectMenu:vn,TextAlignButton:Hn,ToggleButton:hn,ToolbarLayout:sn,UiGroup:an,aButton:w,aButtonActive:D,aButtonDisable:x,aButtonEnable:E,aButtonInactive:R,aButtonIsEnabled:S,aButtonSetIcon:k,aButtonSetLabel:T,aDialog:A,aDialogClose:B,aDialogOpen:N,aMenu:P,aTabs:I,actionApply:L,actionPreview:M,actionPreviewRestore:H,actionRedo:F,actionUndo:U,clean:K,cleanEmptyAttributes:W,cleanEmptyElements:q,cleanRemoveComments:G,cleanReplaceElements:j,cleanUnnestElement:X,cleanUnwrapElements:z,cleanWrapTextNodes:V,dockToElement:J,dockToScreen:_,elementBringToTop:Z,elementChangeTag:ye,elementClosestBlock:me,elementContainsBlockElement:ne,elementDefaultDisplay:oe,elementDetachedManip:fe,elementFirstInvalidElementOfValidParent:se,elementGetAttributes:le,elementGetStyles:ce,elementIsBlock:ie,elementIsEmpty:de,elementIsValid:ae,elementOuterHtml:te,elementOuterText:ee,elementPositionUnder:ge,elementRemoveAttributes:Y,elementSwapStyles:ue,elementToggleStyle:he,elementUniqueId:be,elementVisibleRect:re,elementWrapInner:pe,extendLocale:e,fragmentInsertBefore:we,fragmentToHtml:Ce,getLocalizedString:o,nodeFindParent:Te,nodeFindTextNodes:ke,nodeIsChildOf:Ee,persistGet:xe,persistSet:Se,rangeContainsNode:Ue,rangeContainsNodeText:Fe,rangeDeserialize:We,rangeEmptyTag:Be,rangeExpandTo:Ae,rangeExpandToParent:De,rangeGet:Xe,rangeGetCommonAncestor:Me,rangeGetEndElement:Oe,rangeGetStartElement:Ie,rangeIsContainedBy:Le,rangeIsEmpty:He,rangeReplace:Ne,rangeReplaceSplitInvalidTags:Ge,rangeReplaceWithinValidTags:qe,rangeSelectElement:Re,rangeSelectElementContent:Pe,rangeSerialize:ze,rangeToHtml:Ve,rangeTrim:je,registerLocale:t,selectionAtEndOfElement:hi,selectionAtStartOfElement:ui,selectionChangeTags:Ai,selectionClearFormatting:Ei,selectionConstrain:ki,selectionContains:Ni,selectionDelete:Bi,selectionDestroy:Qe,selectionEachBlock:wi,selectionEachRange:$e,selectionExists:mi,selectionExpandTo:Di,selectionExpandToWord:xi,selectionFindWrappingAndInnerElements:Pi,selectionGetElement:ri,selectionGetElements:li,selectionGetEndElement:pi,selectionGetHtml:si,selectionGetStartElement:ci,selectionInverseWrapWithTagClass:Si,selectionIsEmpty:di,selectionRange:bi,selectionReplace:Ze,selectionReplaceSplittingSelectedElement:yi,selectionReplaceWithinValidTags:vi,selectionRestore:_e,selectionSave:Ke,selectionSaved:Je,selectionSelectEdge:ii,selectionSelectEnd:ni,selectionSelectInner:ti,selectionSelectOuter:ei,selectionSelectStart:oi,selectionSelectToEndOfElement:ai,selectionSet:Ye,selectionToggleBlockClasses:Ti,selectionToggleBlockStyle:Ci,selectionToggleWrapper:gi,selectionTrim:Ri,selectionWrapTagWithAttribute:fi,setLocale:n,stateRestore:Oi,stateSave:Ii,stringHtmlStringIsEmpty:Hi,stringStripTags:Mi,styleRestoreState:Fi,styleSwapState:Li,styleSwapWithWrapper:Ui,tableCanMergeCells:_i,tableCanSplitCells:Ji,tableCellsInRange:Ki,tableCreate:ji,tableDeleteColumn:Wi,tableDeleteRow:qi,tableGetCellByIndex:Xi,tableGetCellIndex:Vi,tableInsertColumn:zi,tableInsertRow:Gi,tableMergeCells:Qi,tableSplitCells:$i,templateConvertTokens:d,templateGet:u,templateGetVariables:g,typeIsArray:b,typeIsElement:C,typeIsNode:y,typeIsNumber:f,typeIsRange:Zi,typeIsSelection:tn,typeIsString:m,typeIsTextNode:v,undockFromElement:$,undockFromScreen:Q}),window.Raptor=Zn,Zn.globalDefaults={layouts:{},plugins:{},ui:{},bind:{},namespace:null,unify:!0,persistence:!0,persistenceName:"uiEditor",unloadWarning:!0,autoEnable:!1,partialEdit:!1,autoSelect:"end",enablePlugins:!0,disabledPlugins:[],enableUi:!0,disabledUi:[],replace:!1,replaceStyle:["display","position","float","width","padding-left","padding-right","padding-top","padding-bottom","margin-left","margin-right","margin-top","margin-bottom"],baseClass:"raptor",cssPrefix:"cms-",draggable:!0},Zn.registerPreset({name:"full",plugins:{imageSwap:{chooser:"insertFile"}},layouts:{toolbar:{uiOrder:[["logo"],["save","cancel"],["dockToScreen","dockToElement","guides"],["viewSource"],["historyUndo","historyRedo"],["alignLeft","alignCenter","alignJustify","alignRight"],["textBold","textItalic","textUnderline","textStrike"],["textSuper","textSub"],["listUnordered","listOrdered"],["hrCreate","textBlockQuote"],["textSizeDecrease","textSizeIncrease","fontFamilyMenu"],["clearFormatting","cleanBlock"],["linkCreate","linkRemove"],["embed","insertFile"],["floatLeft","floatNone","floatRight"],["colorMenuBasic"],["tagMenu"],["classMenu"],["snippetMenu","specialCharacters"],["tableCreate","tableInsertRow","tableDeleteRow","tableInsertColumn","tableDeleteColumn"],["languageMenu"],["statistics"]]},hoverPanel:{uiOrder:[["clickButtonToEdit"]]},elementHoverPanel:{elements:"img",uiOrder:[["imageResize","imageSwap","close"]]}}},!0),Zn.registerPreset({name:"micro",layouts:{toolbar:{uiOrder:[["logo"],["save","cancel"],["dockToScreen","dockToElement"],["historyUndo","historyRedo"],["specialCharacters"],["languageMenu"],["statistics"]]},hoverPanel:{uiOrder:[["clickButtonToEdit","revisions"]]}},plugins:{placeholder:!1,paste:{panels:["plain-text"]},noBreak:{enabled:!0}}}),Zn.registerPreset({name:"inline",classes:"raptor-editing-inline",autoEnable:!0,draggable:!1,unify:!1,unloadWarning:!1,reloadOnDisable:!0,plugins:{unsavedEditWarning:!1,dock:{dockToElement:!0,docked:!0,persist:!1}},layouts:{toolbar:{uiOrder:[["textBold","textItalic","textUnderline","textStrike"],["colorMenuBasic"],["textBlockQuote"],["listOrdered","listUnordered"],["textSizeDecrease","textSizeIncrease"],["linkCreate","linkRemove"]]}}}),Zn.registerPreset({name:"mammoth",plugins:{imageSwap:{chooser:"fileManager"}},layouts:{toolbar:{uiOrder:[["logo"],["save","cancel"],["dockToScreen","guides"],["viewSource"],["historyUndo","historyRedo"],["alignLeft","alignCenter","alignJustify","alignRight"],["textBold","textItalic","textUnderline","textStrike"],["textSuper","textSub"],["listUnordered","listOrdered"],["hrCreate","textBlockQuote"],["textSizeDecrease","textSizeIncrease"],["clearFormatting","cleanBlock"],["linkCreate","linkRemove"],["embed","fileManager"],["floatLeft","floatNone","floatRight"],["colorMenuBasic"],["tagMenu"],["classMenu"],["snippetMenu","specialCharacters","loremIpsum"],["tableCreate","tableInsertRow","tableDeleteRow","tableInsertColumn","tableDeleteColumn"]]},hoverPanel:{uiOrder:[["clickButtonToEdit","revisions"]]},elementHoverPanel:{elements:"img",uiOrder:[["imageResize","imageSwap","imageEditor","close"]]},imageEditor:{uiOrder:[["save","cancel"],["revert","upload"],["undo","redo"],["flipV","flipH","rotateLeft","rotateRight","resize","crop"]]},fileManager:{uiOrder:[["insert","rename","edit","delete","download","view"]]}}},!0),Zn.registerPreset({name:"mammoth-inline",classes:"raptor-editing-inline",autoEnable:!0,draggable:!1,unify:!1,unloadWarning:!1,reloadOnDisable:!0,plugins:{unsavedEditWarning:!1,dock:{dockToElement:!0,docked:!0,persist:!1}},layouts:{toolbar:{uiOrder:[["viewSource","guides"],["historyUndo","historyRedo"],["alignLeft","alignCenter","alignJustify","alignRight"],["textBold","textItalic","textUnderline","textStrike"],["textSuper","textSub"],["listUnordered","listOrdered"],["hrCreate","textBlockQuote"],["textSizeDecrease","textSizeIncrease"],["clearFormatting","cleanBlock"],["linkCreate","linkRemove"],["embed","fileManager"],["floatLeft","floatNone","floatRight"],["colorMenuBasic"],["tagMenu"],["classMenu"],["snippetMenu","specialCharacters"],["tableCreate","tableInsertRow","tableDeleteRow","tableInsertColumn","tableDeleteColumn"]]}}}),Zn.registerUi(new fn({name:"cancel",hotkey:"esc",dialogOptions:{width:500},action:function(){this.raptor.isDirty()?fn.prototype.action.call(this):this.applyAction()},applyAction:function(){this.raptor.cancelEditing()},getDialogTemplate:function(){return Kn("<div>").html(a("cancelDialogContent"))}})),Cn.prototype=Object.create(vn.prototype),Cn.prototype.init=function(){var t=vn.prototype.init.call(this);return"object"==typeof this.options.classes&&Object.keys(this.options.classes).length>0?(this.raptor.bind("selectionChange",this.updateButton.bind(this)),t):void 0},Cn.prototype.changeClass=function(t){Ti(t,[],this.raptor.getElement())},Cn.prototype.menuItemClick=function(t){vn.prototype.menuItemClick.apply(this,arguments),this.raptor.actionApply(function(){this.changeClass([Kn(t.currentTarget).data("value")])}.bind(this))},Cn.prototype.menuItemMouseEnter=function(t){this.raptor.actionPreview(function(){this.changeClass([Kn(t.currentTarget).data("value")])}.bind(this))},Cn.prototype.menuItemMouseLeave=function(){this.raptor.actionPreviewRestore()},Cn.prototype.updateButton=function(){},Cn.prototype.getMenuItems=function(){var t="";for(var e in this.options.classes)t+=this.raptor.getTemplate("class-menu.item",{label:e,value:this.options.classes[e]});return t},Zn.registerUi(new Cn),Zn.registerUi(new pn({name:"cleanBlock",action:function(){this.raptor.getElement().find("[style]").removeAttr("style"),this.raptor.getElement().find("span:empty").remove()}})),Zn.registerUi(new pn({name:"clearFormatting",action:function(){Ei(this.raptor.getElement().get(0)),q(this.raptor.getElement(),["a","b","i","sub","sup","strong","em","big","small","p"]),V(this.raptor.getElement()[0],"p")}})),Zn.registerUi(new cn({name:"clickButtonToEdit",action:function(){this.raptor.enableEditing()}})),Zn.registerUi(new cn({name:"close",click:function(){this.layout.close()}})),wn.prototype=Object.create(vn.prototype),wn.prototype.init=function(){return this.raptor.bind("selectionChange",this.updateButton.bind(this)),this.updateButton(),vn.prototype.init.apply(this,arguments)},wn.prototype.updateButton=function(){var t=li()[0],e=this.getButton().getButton(),i=null,n=null;if(T(e,a("colorMenuBasicAutomatic")),k(e,!1),t){t=Kn(t);for(var o in this.options.colors)if(n=Kn(t).closest("."+this.options.cssPrefix+o),n.length){i=o;break}return i?(T(e,a("colorMenuBasic"+h(i))),k(e,"ui-icon-swatch"),e.find(".ui-icon").css("background-color",n.css("color")),void 0):void 0}},wn.prototype.changeColor=function(t,e){e&&(this.currentColor=t),this.raptor.actionApply(function(){if(xi(),"automatic"===t)li().parents("."+this.options.cssPrefix+"color").addBack().each(function(){var t=Kn(this).attr("class");if(null!==t&&"undefined"!=typeof t&&(t=t.match(/(cms-(.*?))( |$)/gi),null!==t&&"undefined"!=typeof t))for(var e=0,i=t.length;i>e;e++)Kn(this).removeClass(Kn.trim(t[e]))});else{var e=be();gi("span",{classes:this.options.cssPrefix+"color "+this.options.cssPrefix+t,attributes:{id:e}});var i=Kn("#"+e);if(i.length){ti(i.removeAttr("id").get(0));var n;do n=Kn("#"+e),n.removeAttr("id");while(n.length)}}}.bind(this))},wn.prototype.menuItemMouseEnter=function(t){this.raptor.actionPreview(function(){this.changeColor(Kn(t.currentTarget).data("color"))}.bind(this))},wn.prototype.menuItemMouseLeave=function(){this.raptor.actionPreviewRestore()},wn.prototype.menuItemClick=function(t){vn.prototype.menuItemClick.apply(this,arguments),this.raptor.actionApply(function(){this.changeColor(Kn(t.currentTarget).data("color"),!0)}.bind(this))},wn.prototype.getMenuItems=function(){var t=this.raptor.getTemplate("color-menu-basic.automatic",this.options);for(var e in this.options.colors)t+=this.raptor.getTemplate("color-menu-basic.item",{color:this.options.colors[e],label:a("colorMenuBasic"+h(e)),className:e,baseClass:this.options.baseClass});return t},Zn.registerUi(new wn),Tn.prototype=Object.create(on.prototype),Tn.prototype.init=function(){var t;this.options.persist&&(t=this.raptor.persist("docked")),"undefined"==typeof t&&(t=this.options.docked),"undefined"==typeof t&&(t=!1),t&&(this.raptor.bind("toolbarReady",function(){t&&this.toggleState()}.bind(this)),this.raptor.bind("toolbarHide",function(){this.dockState&&this.dockState.spacer&&(this.dockState.spacer.addClass(this.options.baseClass+"-hidden"),this.dockState.spacer.removeClass(this.options.baseClass+"-visible"))}.bind(this)),this.raptor.bind("toolbarShow",function(){this.dockState&&this.dockState.spacer&&(this.dockState.spacer.removeClass(this.options.baseClass+"-hidden"),this.dockState.spacer.addClass(this.options.baseClass+"-visible"))}.bind(this)),this.raptor.bind("toolbarDestroy",function(){this.dockState&&this.dockState.spacer&&this.dockState.spacer.remove()}.bind(this)))},Tn.prototype.toggleState=function(){return this.options.dockToElement?this.toggleDockToElement():this.toggleDockToScreen()},Tn.prototype.toggleDockToElement=function(){this.dockState?"undefined"!=typeof this.dockState.dockedTo?this.undockFromElement():(this.undockFromScreen(),this.dockToElement()):this.dockToElement()},Tn.prototype.dockToElement=function(){var t=this.options.dockTo?Kn(this.options.dockTo):this.raptor.getElement(),e=this.raptor.getLayout("toolbar").getElement();this.marker=Kn("<marker>").addClass(this.options.baseClass+"-marker").insertAfter(e),e.addClass(this.options.baseClass+"-docked-to-element"),this.dockState=J(e,t,{position:this.options.position,spacer:!1,wrapperClass:this.options.baseClass+"-inline-wrapper"}),this.activateButton(this.raptor.getPlugin("dockToElement")),this.raptor.persist("docked",!0)},Tn.prototype.undockFromElement=function(){this.marker.replaceWith($(this.dockState)),this.dockState=null,this.raptor.getLayout("toolbar").getElement().removeClass(this.options.baseClass+"-docked-to-element"),this.deactivateButton(this.raptor.getPlugin("dockToElement")),this.raptor.persist("docked",!1)},Tn.prototype.toggleDockToScreen=function(){this.dockState?"undefined"!=typeof this.dockState.dockedTo?(this.undockFromElement(),this.dockToScreen()):this.undockFromScreen():this.dockToScreen()},Tn.prototype.dockToScreen=function(){if(!this.dockState){var t=this.raptor.getLayout("toolbar");if(t.isReady()){var e=t.getElement();this.marker=Kn("<marker>").addClass(this.options.baseClass+"-marker").insertAfter(e),e.addClass(this.options.baseClass+"-docked"),t.disableDragging(),this.dockState=_(e,{position:this.options.position,spacer:this.options.spacer,under:this.options.under}),t.isVisible()||(this.dockState.spacer.removeClass(this.options.baseClass+"-visible"),this.dockState.spacer.addClass(this.options.baseClass+"-hidden")),this.activateButton(this.raptor.getPlugin("dockToScreen")),this.raptor.persist("docked",!0)}}},Tn.prototype.undockFromScreen=function(){if(this.dockState){var t=this.raptor.getLayout("toolbar"),e=Q(this.dockState);this.marker.replaceWith(e),t.enableDragging(),t.constrainPosition(),this.dockState=null,e.removeClass(this.options.baseClass+"-docked"),this.deactivateButton(this.raptor.getPlugin("dockToScreen")),this.raptor.persist("docked",!1)}},Tn.prototype.deactivateButton=function(t){"undefined"!=typeof t&&"undefined"!=typeof t.button&&R(t.button)},Tn.prototype.activateButton=function(t){"undefined"!=typeof t&&"undefined"!=typeof t.button&&D(t.button)},Zn.registerPlugin(new Tn),Zn.registerUi(new cn({name:"dockToScreen",action:function(){this.raptor.unify(function(t){t.plugins.dock.toggleDockToScreen()})}})),Zn.registerUi(new cn({name:"dockToElement",action:function(){this.raptor.unify(function(t){t.plugins.dock.toggleDockToElement()})}})),Zn.registerUi(new fn({name:"embed",state:null,dialogOptions:{width:600,height:400},applyAction:function(t){this.raptor.actionApply(function(){Ze(t.find("textarea").val())})},getDialogTemplate:function(){var t=Kn("<div>").html(this.raptor.getTemplate("embed.dialog",this.options));t.find("textarea").change(function(e){t.find("."+this.options.baseClass+"-preview").html(Kn(e.target).val())}.bind(this));var e=t.find("."+this.options.baseClass+"-panel-tabs");return e.find("li").click(function(){e.find("ul li").removeClass("ui-state-active").removeClass("ui-tabs-selected"),Kn(this).addClass("ui-state-active").addClass("ui-tabs-selected"),e.children("div").hide().eq(Kn(this).index()).show()}),t}})),Zn.registerUi(new dn({name:"floatLeft",applyToElement:function(t){t.removeClass(this.options.cssPrefix+"float-right"),t.toggleClass(this.options.cssPrefix+"float-left"),W(t,["class"])},getElement:function(t){var e=Kn(t.commonAncestorContainer).find("img");return e.length?e:null}})),Zn.registerUi(new dn({name:"floatNone",applyToElement:function(t){t.removeClass(this.options.cssPrefix+"float-right"),t.removeClass(this.options.cssPrefix+"float-left"),W(t,["class"])},getElement:function(t){var e=Kn(t.commonAncestorContainer).find("img");return e.length?e:null}})),Zn.registerUi(new dn({name:"floatRight",applyToElement:function(t){t.removeClass(this.options.cssPrefix+"float-left"),t.toggleClass(this.options.cssPrefix+"float-right"),W(t,["class"])},getElement:function(t){var e=Kn(t.commonAncestorContainer).find("img");return e.length?e:null}})),Zn.registerUi(new pn({name:"guides",action:function(){this.raptor.getElement().toggleClass(this.getClassName()),this.updateButtonState()},updateButtonState:function(){this.raptor.getElement().hasClass(this.getClassName())?D(this.button):R(this.button)},init:function(){return this.raptor.bind("cancel",this.removeClass.bind(this)),this.raptor.bind("saved",this.removeClass.bind(this)),pn.prototype.init.call(this)},removeClass:function(){this.raptor.getElement().removeClass(this.getClassName())},getClassName:function(){return this.options.baseClass+"-visible"},mouseEnter:function(){pn.prototype.mouseEnter.call(this),this.updateButtonState()},mouseLeave:function(){pn.prototype.mouseLeave.call(this),this.updateButtonState()}})),Zn.registerUi(new cn({name:"historyRedo",hotkey:["ctrl+y","ctrl+shift+z"],action:function(){this.raptor.historyForward()},init:function(){return this.raptor.bind("historyChange",this.historyChange.bind(this)),cn.prototype.init.apply(this,arguments),x(this.button),this.button},historyChange:function(){this.raptor.present<this.raptor.history.length-1?E(this.button):x(this.button)}})),Zn.registerUi(new cn({name:"historyUndo",hotkey:"ctrl+z",action:function(){this.raptor.historyBack()},init:function(){return this.raptor.bind("historyChange",this.historyChange.bind(this)),cn.prototype.init.apply(this,arguments),x(this.button),this.button},historyChange:function(){0===this.raptor.present?x(this.button):E(this.button)}})),Zn.registerUi(new pn({name:"hrCreate",action:function(){Ze("<hr/>")}})),Zn.registerUi(new fn({name:"imageResize",proportional:!0,image:null,dialogOptions:{width:450},action:function(){var t=this.getDialog();this.image=s(this.layout.target),this.originalWidth=this.layout.target.width,this.originalHeight=this.layout.target.height,t.find("[name=width]").val(this.layout.target.width),t.find("[name=height]").val(this.layout.target.height),this.openDialog()},applyAction:function(){var t=this.getDialog(),e=t.find("[name=width]").val(),i=t.find("[name=height]").val();this.raptor.actionApply(function(){Kn("#"+this.image).css({width:e,height:i}).attr("width",e).attr("height",i),ei(Kn("#"+this.image)[0])}.bind(this))},getDialogTemplate:function(){var t=Kn("<div>").html(this.raptor.getTemplate("image-resize.dialog",this.options)),e=this;t.find("."+this.options.baseClass+"-lock-proportions").hover(function(){Kn(this).addClass("ui-state-hover")},function(){Kn(this).removeClass("ui-state-hover")}).click(function(){io[e.name].instance.proportional=!io[e.name].instance.proportional,Kn(this).find(".ui-icon").toggleClass("ui-icon-locked",e.proportional).toggleClass("ui-icon-unlocked",!e.proportional)});var i=t.find("[name=width]"),n=t.find("[name=height]");return i.on("input.raptor",function(){var t=parseInt(Kn(this).val());isNaN(t)||io[e.name].instance.proportional&&n.val(Math.round(Math.abs(io[e.name].instance.originalHeight/io[e.name].instance.originalWidth*t)))}),n.on("input.raptor",function(){var t=parseInt(Kn(this).val());isNaN(t)||io[e.name].instance.proportional&&i.val(Math.round(Math.abs(io[e.name].instance.originalWidth/io[e.name].instance.originalHeight*t)))}),t}})),Zn.registerUi(new cn({name:"imageSwap",chooser:null,click:function(){ei(this.layout.target),this.raptor.getPlugin(this.options.chooser).action(this.layout.target)}})),Zn.registerUi(new fn({name:"insertFile",state:!1,imageTypes:["jpeg","jpg","png","gif"],options:{customAction:!1},action:function(t){return this.options.customAction&&this.options.customAction.call(this,t)!==!1?void 0:("undefined"!=typeof t?(this.getDialog().find("[name=location]").val(t.getAttribute("src")||t.getAttribute("href")),this.getDialog().find("[name=name]").val(t.innerHTML)):(this.getDialog().find("[name=location]").val(""),this.getDialog().find("[name=name]").val("")),this.openDialog())},applyAction:function(){var t=this.getDialog(),e=t.find("[name=location]").val(),i=t.find("[name=name]").val();this.raptor.actionApply(function(){this.insertFiles([{location:e,name:i}])}.bind(this))},getDialogTemplate:function(){return Kn(this.raptor.getTemplate("insert-file.dialog"))},getFileType:function(t){if("undefined"!=typeof t.extension)return t.extension.toLowerCase();var e=t.location.split(".");return e.length>0?e.pop().toLowerCase():"unknown"},isImage:function(t){return-1!==Kn.inArray(this.getFileType(t),this.imageTypes)},insertFiles:function(t){this.raptor.resume(),t.length&&this.raptor.actionApply(function(){1===t.length?this.isImage(t[0])&&Kn(si()).is("img")||di()?this.replaceFiles(t):this.linkFiles(t):this.linkFiles(t)}.bind(this))},linkFiles:function(t){Di("a",this.raptor.getElement()),Ri();var e=rangy.createApplier({tag:"a",attributes:{href:t[0].location.replace(/([^:])\/\//g,"$1/"),title:t[0].name,"class":this.options.cssPrefix+"file "+this.options.cssPrefix+this.getFileType(t[0])}});e.applyToSelection()},replaceFiles:function(t){for(var e=[],i=0;i<t.length;i++)e.push(this.prepareElement(t[i]));Ze(e.join(", "))},prepareElement:function(t,e){return this.isImage(t)?this.prepareImage(t,this.options.cssPrefix+this.getFileType(t),e):this.prepareAnchor(t,this.options.cssPrefix+"file "+this.options.cssPrefix+this.getFileType(t),e)},prepareImage:function(t,e,i){return Kn("<div/>").html(Kn("<img/>").attr({src:t.location.replace(/([^:])\/\//g,"$1/"),title:i||t.name,"class":e})).html()},prepareAnchor:function(t,e,i){return Kn("<div/>").html(Kn("<a/>").attr({href:t.location.replace(/([^:])\/\//g,"$1/"),title:t.name,"class":e}).html(i||t.name)).html()}}));var no,oo,ao,so;Zn.registerUi(new mn({name:"linkCreate",dialogOptions:{width:850},applyAction:function(){this.raptor.actionApply(function(){xi(),Di("a",this.raptor.getElement()),Ri();var t=rangy.createApplier({tag:"a",attributes:so});so!==!1&&""!==Kn.trim(so.href)&&(t.applyToSelection(),q(this.raptor.getElement(),["a"]))}.bind(this))},openDialog:function(){var t=ri();if(t.is("a"))for(var e=0,i=oo.length;i>e;e++){var n=oo[e].updateInputs(t,ao.children("div:eq("+e+")"));n&&no.find(":radio:eq("+e+")").trigger("click")
}mn.prototype.openDialog.call(this)},validateDialog:function(){var t=no.find(":radio:checked").val();return so=oo[t].getAttributes(ao.children("div:eq("+t+")")),so!==!1},selectionToggle:function(){var t=ri();return t?t.closest("a").length?!0:!1:!1},getDialogTemplate:function(){var t=Kn(this.raptor.getTemplate("link.dialog",this.options));no=t.find("[data-menu]"),ao=t.find("[data-content]"),oo=[new xn(this.raptor),new Sn(this.raptor),new kn(this.raptor),new En(this.raptor)];for(var e=0,i=oo.length;i>e;e++)Kn(this.raptor.getTemplate("link.label",oo[e])).click(function(){ao.children("div").hide(),ao.children("div:eq("+Kn(this).index()+")").show()}).find(":radio").val(e).end().appendTo(no),Kn("<div>").append(oo[e].getContent()).hide().appendTo(ao);return no.find(":radio:first").prop("checked",!0),ao.children("div:first").show(),t}})),Zn.registerUi(new un({name:"linkRemove",disable:!0,action:function(){this.raptor.actionApply(function(){var t=rangy.createApplier({tag:"a"});xi(),this.raptor.selectionConstrain(),t.undoToSelection(),q(this.raptor.getElement(),["a"])}.bind(this))},selectionToggle:function(){var t=ri();return t?t.closest("a").length?!0:!1:!1}})),kn.prototype=Object.create(Sn.prototype),kn.prototype.getContent=function(){return this.raptor.getTemplate("link.document",this.raptor.options)},En.prototype.getContent=function(){return this.raptor.getTemplate("link.email",this.raptor.options)},En.prototype.getAttributes=function(t){var e=t.find("[name=email]").val(),i=t.find("[name=subject]").val();return Kn.trim(i)&&(i="?Subject="+encodeURIComponent(i)),""===Kn.trim(e)?!1:{href:"mailto:"+e+i}},En.prototype.updateInputs=function(t,e){var i=!1;if(email="",subject="",href=t.attr("href"),0===href.indexOf("mailto:")){var n=href.indexOf("?Subject=");n>0?(email=href.substring(7,n),subject=href.substring(n+9)):(email=href.substring(7),subject=""),i=!0}return e.find("[name=email]").val(email),e.find("[name=subject]").val(subject),i},Sn.prototype.getContent=function(){return this.raptor.getTemplate("link.external",this.raptor.options)},Sn.prototype.getAttributes=function(t){var e=t.find("[name=location]").val(),i=t.find("[name=blank]").is(":checked"),n={href:e};return i&&(n.target="_blank"),"http://"===Kn.trim(n.href)?!1:n},Sn.prototype.updateInputs=function(t,e){var i=!1,n=t.attr("href");return 0===n.indexOf("http://")?(e.find("[name=location]").val(n),i=!0):e.find("[name=location]").val("http://"),"_blank"===t.attr("target")?e.find("[name=blank]").prop("checked",!0):e.find("[name=blank]").prop("checked",!1),i},xn.prototype.getContent=function(){return this.raptor.getTemplate("link.internal",{baseClass:this.raptor.options.baseClass,domain:window.location.protocol+"//"+window.location.host})},xn.prototype.getAttributes=function(t){var e=t.find("[name=location]").val(),i=t.find("[name=blank]").is(":checked"),n={href:e};return i&&(n.target="_blank"),n},xn.prototype.updateInputs=function(t,e){var i=t.attr("href");return-1===i.indexOf("http://")&&-1===i.indexOf("mailto:")?e.find("[name=location]").val(i):e.find("[name=location]").val(""),"_blank"===t.attr("target")?e.find("[name=blank]").prop("checked",!0):e.find("[name=blank]").prop("checked",!1),!1},Zn.registerUi(new cn({name:"listOrdered",action:function(){document.execCommand("insertOrderedList")}})),Zn.registerUi(new cn({name:"listUnordered",action:function(){document.execCommand("insertUnorderedList")}})),Zn.registerUi(new cn({name:"logo",action:function(){window.open("http://www.raptor-editor.com/about/VERSION","_blank")}})),Dn.prototype=Object.create(on.prototype),Dn.prototype.init=function(){this.raptor.getElement().on("keypress.raptor",this.preventReturn.bind(this)),this.raptor.getElement().on("drop.raptor",this.preventDrop.bind(this))},Dn.prototype.preventReturn=function(t){return this.options.enabled&&13===t.which?!1:void 0},Dn.prototype.preventDrop=function(){return this.options.enabled},Zn.registerPlugin(new Dn),Rn.prototype=Object.create(on.prototype),Rn.prototype.init=function(){this.raptor.registerHotkey("return",this.returnPressed.bind(this)),this.raptor.registerHotkey("shift+return",this.shiftReturnPressed.bind(this))},Rn.prototype.returnPressedList=function(t){var e=t.closest("li");if(!e.length)return!1;var i=e.closest("ul, ol"),n=i.get(0).tagName.toLowerCase(),o=!1;if(de(e)){var a=e.next();a.length&&a.is("li")?(o=listBreakByReplacingSelection(n,"li",this.raptor.getElement(),"<p>&nbsp;</p>"),o&&ti(o.get(0))):(e.remove(),ti(Kn("<p>&nbsp;</p>").insertAfter(i).get(0)))}else o=listBreakAtSelection(n,"li",this.raptor.getElement()),o&&oi(o.get(0));return!0},Rn.prototype.returnPressed=function(){var t=ri();return this.returnPressedList(t)?!0:!1},Rn.prototype.shiftReturnPressedList=function(t){if(t.closest("li").length){var e=t.closest("ul, ol").get(0).tagName.toLowerCase(),i=listBreakByReplacingSelection(e,"li",this.raptor.getElement(),"<p>&nbsp;</p>");return i&&ti(i.get(0)),!0}return!1},Rn.prototype.shiftReturnPressed=function(){var t=ri();return this.shiftReturnPressedList(t)?!0:!1},Zn.registerPlugin(new Rn);var ro=!1,lo=null,co=null,po=null;Pn.prototype=Object.create(on.prototype),Pn.prototype.enable=function(){this.raptor.getElement().on("paste.raptor",this.capturePaste.bind(this))},Pn.prototype.capturePaste=function(){return po?void 0:ro?!1:(Ke(),ro=!0,Kn(".raptorPasteBin").remove(),Kn('<div class="raptorPasteBin" contenteditable="true" style="width: 1px; height: 1px; overflow: hidden; position: fixed; top: -1px;" />').appendTo("body"),Kn(".raptorPasteBin").focus(),window.setTimeout(this.showPasteDialog.bind(this),0),!0)},Pn.prototype.showPasteDialog=function(){N(this.getDialog(this))},Pn.prototype.pasteContent=function(t){this.raptor.actionApply(function(){var e=be();_e(),t=this.filterAttributes(t),t=this.filterChars(t),Ze(Kn('<placeholder id="'+e+'">'+t+"</placeholder>")),Kn(".raptorPasteBin").remove();var i=Kn("#"+e);ti(i.get(0)),Ke(),i.contents().unwrap(),_e()}.bind(this))},Pn.prototype.getDialog=function(t){if(co=t,!lo){lo=Kn("<div>").html(this.raptor.getTemplate("paste.dialog",this.options));for(var e=0,i=this.options.panels.length;i>e;e++)lo.find("."+this.options.baseClass+"-tab-"+this.options.panels[e]).css("display",""),0===e&&lo.find("."+this.options.baseClass+"-content-"+this.options.panels[e]).css("display","");lo.find("."+this.options.baseClass+"-panel-tabs > div:visible:not(:first)").hide(),A(lo,{modal:!0,resizable:!0,autoOpen:!1,width:800,height:500,title:a("pasteDialogTitle"),dialogClass:this.options.baseClass+"-dialog",close:function(){ro=!1},buttons:[{text:a("pasteDialogOKButton"),click:function(){var t=null,e=lo.find("."+this.options.baseClass+"-area:visible");t=e.hasClass(this.options.baseClass+"-plain")||e.hasClass(this.options.baseClass+"-source")?e.val():e.html(),B(lo),co.pasteContent(t)}.bind(this),icons:{primary:"ui-icon-circle-check"}},{text:a("pasteDialogCancelButton"),click:function(){Qe(),Kn(".raptorPasteBin").remove(),B(lo)},icons:{primary:"ui-icon-circle-close"}}]});var n=lo.find("."+this.options.baseClass+"-panel-tabs");n.find("li").click(function(){n.find("ul li").removeClass("ui-state-active").removeClass("ui-tabs-selected"),Kn(this).addClass("ui-state-active").addClass("ui-tabs-selected"),n.children("div").hide().eq(Kn(this).index()).show()})}return this.updateAreas(),lo},Pn.prototype.filterAttributes=function(t){var e=[{regexp:/(<meta\s*[^>]*\s*>)|(<\s*link\s* href="file:[^>]*\s*>)|(<\/?\s*\w+:[^>]*\s*>)/gi,handler:""},{regexp:/(class="Mso[^"]*")|(<!--(.|\s){1,}?-->)/gi,handler:""},{regexp:/(class="Apple-(style|converted)-[a-z]+\s?[^"]+")/,handle:""},{regexp:/id="internal-source-marker_[^"]+"|dir="[rtl]{3}"/,handle:""},{regexp:/(<p[^>]*>\s*(\&nbsp;|\u00A0)*\s*<\/p[^>]*>)|(<p[^>]*>\s*<font[^>]*>\s*(\&nbsp;|\u00A0)*\s*<\/\s*font\s*>\s<\/p[^>]*>)/gi,handler:""},{regexp:/(style="[^"]*mso-[^;][^"]*")|(style="margin:\s*[^;"]*;")/gi,handler:""},{regexp:/(?:<style([^>]*)>([\s\S]*?)<\/style>|<link\s+(?=[^>]*rel=['"]?stylesheet)([^>]*?href=(['"])([^>]*?)\4[^>\/]*)\/?>)/gi,handler:""},{regexp:/(<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>)|(<\s*script\b([^<>]|\s)*>?)|(<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>)/gi,handler:""}];return Kn.each(e,function(e,i){t=t.replace(i.regexp,i.handler)}),t},Pn.prototype.filterChars=function(t){var e=t;return e=e.replace(/[\u2018|\u2019|\u201A]/g,"'"),e=e.replace(/[\u201C|\u201D|\u201E]/g,'"'),e=e.replace(/\u2026/g,"..."),e=e.replace(/[\u2013|\u2014]/g,"-"),e=e.replace(/\u02C6/g,"^"),e=e.replace(/\u2039/g,"<"),e=e.replace(/\u203A/g,">"),e=e.replace(/[\u02DC|\u00A0]/g," ")},Pn.prototype.stripAttributes=function(t){t=Kn("<div/>").html(t);var e=this.options.allowedAttributes;return Kn(t.find("*")).each(function(){var t=[];Kn.each(this.attributes,function(i,n){-1===Kn.inArray(n.nodeName,e)&&t.push(n.nodeName)});for(var i=0;i<t.length;i++)Kn(this).attr(t[i],null)}),t.html()},Pn.prototype.stripEmpty=function(t){var e=Kn("<div/>").html(t),i=this.options.allowedEmptyTags;return e.find("*").filter(function(){return-1!==Kn.inArray(this.tagName.toLowerCase(),i)?!1:Kn(this).find(i.join(",")).length?!1:""===Kn.trim(Kn(this).text())}).remove(),e.html()},Pn.prototype.stripSpans=function(t){var e=Kn("<div/>").html(t);return e.find("span").each(function(){this.attributes.length||Kn(this).replaceWith(Kn(this).html())}),e.html()},Pn.prototype.updateAreas=function(){var t=Kn(".raptorPasteBin").html();t=this.filterAttributes(t),t=this.filterChars(t),t=this.stripEmpty(t),t=this.stripAttributes(t),t=this.stripSpans(t),t=Mi(t,this.options.allowedTags);var e=Kn("<div/>").html(Kn(".raptorPasteBin").html()).text(),i=Kn(".raptorPasteBin").html();lo.find("."+this.options.baseClass+"-plain").val(Kn("<div/>").html(e).text()),lo.find("."+this.options.baseClass+"-rich").html(t),lo.find("."+this.options.baseClass+"-source").html(i),lo.find("."+this.options.baseClass+"-markup").html(t)},Kn(document).on("keyup.raptor keydown.raptor",function(t){po=t.shiftKey}),Zn.registerPlugin(new Pn),An.prototype=Object.create(on.prototype),An.prototype.init=function(){this.raptor.bind("enabled",this.enabled.bind(this)),this.raptor.bind("change",this.check.bind(this))},An.prototype.enabled=function(){this.check(this.raptor.getHtml())},An.prototype.check=function(t){if(t=t.trim(),!t||"<br>"===t||"<div><br></div>"===t){var e=this.raptor.getNode(),i=document.createElement(this.options.tag);i.innerHTML=this.options.content,e.innerHTML="",e.appendChild(i),this.options.select&&ti(e.childNodes[0]),this.raptor.checkChange()}},Zn.registerPlugin(new An),Zn.registerUi(new cn({name:"save",action:function(){this.getPlugin()?this.getPlugin().save():O({text:a("saveNotConfigured"),type:"error"})},init:function(){if(null!==this.options.plugin){var t=cn.prototype.init.apply(this,arguments);return this.raptor.bind("dirty",this.dirty.bind(this)),this.raptor.bind("cleaned",this.clean.bind(this)),this.clean(),t}},getPlugin:function(){return this.raptor.getPlugin(this.options.plugin)},dirty:function(){E(this.button)},clean:function(){x(this.button)}})),Nn.prototype=Object.create(vn.prototype),Nn.prototype.init=function(){var t=vn.prototype.init.call(this);return"undefined"!=typeof this.options.snippets&&Object.keys(this.options.snippets).length>0?t:void 0},Nn.prototype.insertSnippet=function(t){Ze(this.options.snippets[t])},Nn.prototype.menuItemMouseDown=function(t){this.raptor.actionApply(function(){this.insertSnippet(Kn(t.currentTarget).data("name"))}.bind(this))},Nn.prototype.menuItemMouseEnter=function(t){this.raptor.actionPreview(function(){this.insertSnippet(Kn(t.currentTarget).data("name"))}.bind(this))},Nn.prototype.menuItemMouseLeave=function(){this.raptor.actionPreviewRestore()},Nn.prototype.getMenuItems=function(){var t="";for(var e in this.options.snippets)t+=this.raptor.getTemplate("snippet-menu.item",{name:e});return t},Zn.registerUi(new Nn);var ho=!1;Zn.registerUi(new fn({name:"specialCharacters",dialogOptions:{width:645},options:{setOrder:["symbols","mathematics","arrows","greekAlphabet"],characterSets:{symbols:{name:a("specialCharactersSymbols"),characters:[["<","&lt;","less than"],[">","&gt;","greater than"],["&","&amp;","ampersand"],['"',"&quot;","quotation mark"],["&nbsp;","non-breaking space: ' '"],["&emsp;","em space: '  '"],["&ensp;","en space: ' '"],["&thinsp;","thin space: ''"],["&mdash;","em dash"],["&ndash;","en dash"],["&minus;","minus"],["-","hyphen"],["&oline;","overbar space"],["&cent;","cent"],["&pound;","pound"],["&euro;","euro"],["&sect;","section"],["&dagger;","dagger"],["&Dagger;","double dagger"],["&lsquo;","left single quotes"],["&rsquo;","right single quotes"],["'","single quotes"],["&#x263a;","smiley face"],["&#x2605;","black star"],["&#x2606;","white star"],["&#x2610;","check box"],["&middot;","middle dot"],["&bull;","bullet"],["&copy;","copyright"],["&reg;","registered"],["&trade;","trade"],["&iquest;","inverted question mark"],["&iexcl;","inverted exclamation mark"],["&Aring;","Angstrm"],["&hellip;","ellipsis"],["&#x2295;","earth"],["&#x2299;","sun"],["&#x2640;","female"],["&#x2642;","male"],["&clubs;","clubs or shamrock"],["&spades;","spades"],["&hearts;","hearts or valentine"],["&diams;","diamonds"],["&loz;","diamond"]]},mathematics:{name:a("specialCharactersMathematics"),characters:[["&lt;","less than"],["&le;","less than or equal to"],["&gt;","greater than"],["&ge;","greater than or equal to"],["&ne;","not equal"],["&asymp;","approximately equal to"],["&equiv;","identically equal to"],["&cong;","congruent to"],["&prop;","proportional"],["&there4;","therefore"],["&sum;","summation"],["&prod;","product"],["&prime;","prime or minutes"],["&Prime;","double prime or seconds"],["&Delta;","delta"],["&nabla;","del"],["&part;","partial"],["&int;","integral"],["&middot;","middle dot"],["&sdot;","dot operator"],["&bull;","bullet"],["&minus;","minus sign"],["&times;","multipllcation sign"],["&divide;","division sign"],["&frasl;","fraction slash, (ordinary / \\)"],["&plusmn;","plus or minus"],["&deg;","degree sign"],["&lfloor;","floor function"],["&rfloor;","floor function"],["&lceil;","ceiling function"],["&rceil;","ceiling function"],["&lowast;","asterisk operator, (ordinary *)"],["&oplus;","circled plus"],["&otimes;","circled times"],["&ordm;","masculine ordinal"],["&lang;","bra"],["&rang;","ket"],["&infin;","infinity"],["&pi;","pi"],["&frac12;","half"],["&alefsym;","aleph"],["&radic;","radical"],["&ang;","angle"],["&perp;","perpendicular"],["&real;","real"],["&isin;","is an element of"],["&notin;","not an element of"],["&empty;","null set"],["&sub;","subset of"],["&sube;","subset or or equal to"],["&nsub;","not a subset"],["&cap;","intersection"],["&cup;","union"],["&sim;","tilde operator (ordinary ~)"],["&Oslash;","slash O"],["&and;","logical and"],["&Lambda;","lambda (and)"],["&or;","logical or"],["&not;","not sign"],["&sim;","tilde operator (ordinary ~)"],["&rarr;","right arrow"],["&rArr;","double right arrow"],["&larr;","left arrow"],["&lArr;","left double arrow"],["&harr;","left right arrow"],["&hArr;","left right double arrow"]]},arrows:{name:a("specialCharactersArrows"),characters:[["&darr;","down arrow"],["&dArr;","down double arrow"],["&uarr;","up arrow"],["&uArr;","up double arrow"],["&crarr;","arriage return arrow"],["&rarr;","right arrow"],["&rArr;","double right arrow"],["&larr;","left arrow"],["&lArr;","left double arrow"],["&harr;","left right arrow"],["&hArr;","left right double arrow"]]},greekAlphabet:{name:a("specialCharactersGreekAlphabet"),characters:[["&alpha;","alpha"],["&beta;","beta"],["&gamma;","gamma"],["&delta;","delta"],["&epsilon;","epsilon"],["&zeta;","zeta"],["&eta;","eta"],["&theta;","theta"],["&iota;","iota"],["&kappa;","kappa"],["&lambda;","lambda"],["&mu;","mu"],["&nu;","nu"],["&xi;","xi"],["&omicron;","omicron"],["&pi;","pi"],["&rho;","rho"],["&sigma;","sigma"],["&tau;","tau"],["&upsilon;","upsilon"],["&phi;","phi"],["&chi;","chi"],["&psi;","psi"],["&omega;","omega"],["&Alpha;","alpha"],["&Beta;","beta"],["&Gamma;","gamma"],["&Delta;","delta"],["&Epsilon;","epsilon"],["&Zeta;","zeta"],["&Eta;","eta"],["&Theta;","theta"],["&Iota;","iota"],["&Kappa;","kappa"],["&Lambda;","lambda"],["&Mu;","mu"],["&Nu;","nu"],["&Xi;","xi"],["&Omicron;","omicron"],["&Pi;","pi"],["&Rho;","rho"],["&Sigma;","sigma"],["&Tau;","tau"],["&Upsilon;","upsilon"],["&Phi;","phi"],["&Chi;","chi"],["&Psi;","psi"],["&Omega;","omega"]]}}},applyAction:function(){this.raptor.actionApply(function(){ho&&Ze(ho),ho=!1})},getDialogTemplate:function(){for(var t,e,i,n,o=Kn(this.raptor.getTemplate("special-characters.dialog")).appendTo("body").hide(),a=0;a<this.options.setOrder.length;a++){t=this.options.setOrder[a],o.find("ul").append(this.raptor.getTemplate("special-characters.tab-li",{baseClass:this.options.baseClass,name:this.options.characterSets[t].name,key:t})),e=Kn(this.raptor.getTemplate("special-characters.tab-content",{baseClass:this.options.baseClass,key:t}));for(var s=[],r=0;r<this.options.characterSets[t].characters.length;r++)i=this.options.characterSets[t].characters[r],n=this.raptor.getTemplate("special-characters.tab-button",{htmlEntity:i[0],description:i[1],setKey:t,charactersIndex:r}),s.push(n);e.append(s.join("")),o.find("ul").after(e)}o.show();var l=this;return o.find("button").each(function(){w(Kn(this))}).click(function(){var t=Kn(this).attr("data-setKey"),e=Kn(this).attr("data-charactersIndex");ho=l.options.characterSets[t].characters[e][0],l.getOkButton(l.name).click.call(this)}),I(o),o},getCancelButton:function(){}})),Bn.prototype=Object.create(dn.prototype),Bn.prototype.getElement=function(t){var e=Kn(t.commonAncestorContainer.parentNode).closest("td, th");return e.length?e[0]:null},In.prototype=Object.create(yn.prototype),In.prototype.createTable=function(t){this.raptor.actionApply(function(){Ze(te(Kn(ji(t.target.cellIndex+1,t.target.parentNode.rowIndex+1,{placeHolder:"&nbsp;"}))))})},In.prototype.highlight=function(t){var e=Ki(this.menuTable.get(0),{x:0,y:0},{x:t.target.cellIndex,y:t.target.parentNode.rowIndex});this.highlightRemove(t),Kn(e).addClass(this.options.baseClass+"-menu-hover"),this.raptor.actionPreview(function(){Ze(te(Kn(ji(t.target.cellIndex+1,t.target.parentNode.rowIndex+1,{placeHolder:"&nbsp;"}))))})},In.prototype.highlightRemove=function(){this.menuTable.find("."+this.options.baseClass+"-menu-hover").removeClass(this.options.baseClass+"-menu-hover"),this.raptor.actionPreviewRestore()},In.prototype.getMenu=function(){return this.menu||(this.menuContent=this.raptor.getTemplate("table.create-menu",this.options),yn.prototype.getMenu.call(this).on("click","td",this.createTable.bind(this)).on("mouseenter","td",this.highlight.bind(this)).mouseleave(this.highlightRemove.bind(this)),this.menuTable=this.menu.find("table:eq(0)")),this.menu},Zn.registerUi(new In),Zn.registerUi(new Bn({name:"tableDeleteColumn",applyToElement:function(t){var e,i=Vi(t),n=t.parentNode.parentNode.parentNode;return Wi(t.parentNode.parentNode.parentNode,i.x),Yi(n)?(n.parentNode.removeChild(n),void 0):(e=Xi(n,i),!e&&i.x>0&&(e=Xi(n,{x:i.x-1,y:i.y})),ti(e),void 0)}})),Zn.registerUi(new Bn({name:"tableDeleteRow",applyToElement:function(t){var e,i=Vi(t),n=t.parentNode.parentNode.parentNode;return qi(t.parentNode.parentNode.parentNode,i.y),Yi(n)?(n.parentNode.removeChild(n),void 0):(e=Xi(n,i),!e&&i.y>0&&(e=Xi(n,{x:i.x,y:i.y-1})),ti(e),void 0)}})),Zn.registerUi(new Bn({name:"tableInsertColumn",applyToElement:function(t){zi(t.parentNode.parentNode.parentNode,Vi(t).x+1,{placeHolder:"&nbsp;"})}})),Zn.registerUi(new Bn({name:"tableInsertRow",applyToElement:function(t){Gi(t.parentNode.parentNode.parentNode,Vi(t).y+1,{placeHolder:"&nbsp;"})}})),Zn.registerUi(new cn({name:"tableMergeCells",action:function(){}})),Zn.registerUi(new cn({name:"tableSplitCells",action:function(){}}));var uo=!1,go=null;On.prototype=Object.create(on.prototype),On.prototype.init=function(){this.raptor.bind("selectionCustomise",this.selectionCustomise.bind(this)),this.raptor.registerHotkey("tab",this.tabToNextCell.bind(this)),this.raptor.registerHotkey("shift+tab",this.tabToPrevCell.bind(this)),this.raptor.getElement().on("mousedown","tbody td",this.cellMouseDown.bind(this)).on("mouseover","tbody td",this.cellMouseOver.bind(this)).mouseup(this.cellMouseUp.bind(this))},On.prototype.selectionCustomise=function(){var t,e=[];return Kn("."+this.options.baseClass+"-cell-selected").each(function(){t=rangy.createRange(),t.selectNodeContents(this),e.push(t)}),e},On.prototype.cellMouseDown=function(t){this.raptor.isEditing()&&(go=Vi(t.target),null!==go&&(uo=!0,Kn(t.target).closest("table").addClass(this.options.baseClass+"-selected")))},On.prototype.cellMouseUp=function(t){uo=!1;var e=Kn(t.target).closest("td"),i=!1;if(e.length>0&&null!==go){var n=Vi(e.get(0));(null===n||n.x==go.x&&n.y==go.y)&&(i=!0)}else i=!0;i&&(Kn("."+this.options.baseClass+"-selected").removeClass(this.options.baseClass+"-selected"),Kn("."+this.options.baseClass+"-cell-selected").removeClass(this.options.baseClass+"-cell-selected"))},On.prototype.cellMouseOver=function(t){if(uo){var e=Ki(Kn(t.target).closest("table").get(0),go,Vi(t.target));Kn("."+this.options.baseClass+"-cell-selected").removeClass(this.options.baseClass+"-cell-selected"),Kn(e).addClass(this.options.baseClass+"-cell-selected"),rangy.getSelection().removeAllRanges()}},On.prototype.tabToNextCell=function(){var t=rangy.getSelection().getRangeAt(0),e=Me(t),i=Kn(e).closest("td");if(0===i.length)return!1;var n=i.next("td");0===n.length&&(n=i.closest("tr").next("tr").find("td:first"),0===n.length&&(n=i.closest("tbody").find("td:first"))),Pe(t,n),rangy.getSelection().setSingleRange(t)},On.prototype.tabToPrevCell=function(){var t=rangy.getSelection().getRangeAt(0),e=Me(t),i=Kn(e).closest("td");if(0===i.length)return!1;var n=i.prev("td");0===n.length&&(n=i.closest("tr").prev("tr").find("td:last"),0===n.length&&(n=i.closest("tbody").find("td:last"))),Pe(t,n),rangy.getSelection().setSingleRange(t)},Zn.registerPlugin(new On),Mn.prototype=Object.create(vn.prototype),Mn.prototype.init=function(){return this.raptor.bind("selectionChange",this.updateButton.bind(this)),vn.prototype.init.apply(this,arguments)},Mn.prototype.changeTag=function(t){if("undefined"!=typeof t&&"na"!==t){var e=ri(),i=this.raptor.getElement();if(e&&!e.is(i)){var n=e.closest("td, li, #"+i.attr("id"));0!==n.length&&(i=n)}Ai(t,["h1","h2","h3","h4","h5","h6","p","div","pre","address"],i)}},Mn.prototype.menuItemClick=function(t){vn.prototype.menuItemClick.apply(this,arguments),this.raptor.actionApply(function(){this.changeTag(Kn(t.currentTarget).data("value"))}.bind(this))},Mn.prototype.menuItemMouseEnter=function(t){this.raptor.actionPreview(function(){this.changeTag(Kn(t.currentTarget).data("value"))}.bind(this))},Mn.prototype.menuItemMouseLeave=function(){this.raptor.actionPreviewRestore()},Mn.prototype.updateButton=function(){var t=li()[0],e=this.getButton().getButton();if(t){var i=t.tagName.toLowerCase(),n=this.getMenu().find("[data-value="+i+"]");n.length?T(e,n.html()):T(e,a("tagMenuTagNA"))}},Mn.prototype.getMenuItems=function(){return this.raptor.getTemplate("tag-menu.menu",this.options)},Zn.registerUi(new Mn),Hn.prototype=Object.create(un.prototype),Hn.prototype.action=function(){Ti([this.getClass()],[this.options.cssPrefix+"center",this.options.cssPrefix+"left",this.options.cssPrefix+"right",this.options.cssPrefix+"justify"],this.raptor.getElement(),"span"),this.selectionChange()},Hn.prototype.selectionToggle=function(){return rangy.getSelection().getAllRanges().length>0&&Ni("."+this.getClass(),this.raptor.getElement())},Zn.registerUi(new Hn({name:"alignCenter",getClass:function(){return this.options.cssPrefix+"center"}})),Zn.registerUi(new Hn({name:"alignJustify",getClass:function(){return this.options.cssPrefix+"justify"}})),Zn.registerUi(new Hn({name:"alignLeft",getClass:function(){return this.options.cssPrefix+"left"}})),Zn.registerUi(new Hn({name:"alignRight",getClass:function(){return this.options.cssPrefix+"right"}})),Zn.registerUi(new gn({name:"textBold",hotkey:"ctrl+b",tag:"strong",classes:["bold"]})),Zn.registerUi(new gn({name:"textItalic",hotkey:"ctrl+i",tag:"em",classes:["italic"]})),Zn.registerUi(new gn({name:"textStrike",tag:"del",classes:["strike"]})),Zn.registerUi(new pn({name:"textSizeDecrease",action:function(){xi(),this.raptor.selectionConstrain(),Si("small",this.options.cssPrefix+"small","big",this.options.cssPrefix+"big"),this.raptor.getElement().find("small."+this.options.cssPrefix+"small:empty, big."+this.options.cssPrefix+"big:empty").remove()}})),Zn.registerUi(new pn({name:"textSizeIncrease",action:function(){xi(),this.raptor.selectionConstrain(),Si("big",this.options.cssPrefix+"big","small",this.options.cssPrefix+"small"),this.raptor.getElement().find("small."+this.options.cssPrefix+"small:empty, big."+this.options.cssPrefix+"big:empty").remove()}})),Zn.registerUi(new gn({name:"textUnderline",hotkey:"ctrl+u",tag:"u",classes:["underline"]})),Zn.registerUi(new gn({name:"textSub",tag:"sub",classes:["sub"]})),Zn.registerUi(new gn({name:"textSuper",tag:"sup",classes:["sup"]})),Ln.prototype=Object.create(on.prototype),Ln.prototype.init=function(){this.raptor.bind("layoutReady",function(t){Kn(t).on("mouseover","[title]",function(){Kn(this).attr("data-title",Kn(this).attr("title")).removeAttr("title")})})},Zn.registerPlugin(new Ln);var fo=0,mo=null;Un.prototype=Object.create(on.prototype),Un.prototype.enable=function(){this.raptor.bind("dirty",this.show.bind(this)),this.raptor.bind("cleaned",this.hide.bind(this))},Un.prototype.show=function(){fo++,Z(this.getElement()),this.getElement().addClass(this.options.baseClass+"-visible")},Un.prototype.hide=function(){0===--fo&&this.getElement().removeClass(this.options.baseClass+"-visible")},Un.prototype.getElement=function(){if(!mo){var t="raptor-plugin-unsaved-edit-warning-dirty";mo=Kn(this.raptor.getTemplate("unsaved-edit-warning.warning",this.options)).mouseenter(function(){Zn.eachInstance(function(e){e.isDirty()&&e.getElement().addClass(t)})}).mouseleave(function(){Kn("."+t).removeClass(t)}).appendTo("body")}return mo},Zn.registerPlugin(new Un),Zn.registerUi(new fn({name:"viewSource",dialogOptions:{width:600,height:400},applyAction:function(t){var e=t.find("textarea").val();this.raptor.actionApply(function(){this.raptor.setHtml(e),oi(this.raptor.getElement().first()),this.raptor.checkSelectionChange()}.bind(this))},openDialog:function(){var t=this.getDialog().find("textarea");t.val(this.raptor.getHtml()),fn.prototype.openDialog.call(this),t.select()},getDialogTemplate:function(){return Kn("<div>").html(this.raptor.getTemplate("view-source.dialog",this.options))}}))}();